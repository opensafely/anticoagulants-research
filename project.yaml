version: "3.0"

expectations:
  population_size: 100000

actions:
  generate_cohort:
    run: cohortextractor:latest generate_cohort 
    outputs:
      highly_sensitive:
        cohort1: output/input_af.csv
        cohort2: output/input_af_population_flow_chart.csv
        cohort3: output/input_general_population.csv
        cohort4: output/input_general_population_flow_chart.csv

  # Flowchart for AF population
  flowchart_af:
    run: stata-mp:latest analysis/flow_chart_af_population.do af_population_flowchart
    needs: [generate_cohort]
    outputs:
      moderately_sensitive:
        log: output/oac_log/flow_chart_af_population.log
 
  # Flowchart for general population (before matching)
  flowchart_general_population:
    run: stata-mp:latest analysis/flow_chart_general_population.do general_population_flowchart
    needs: [generate_cohort]
    outputs:
      moderately_sensitive:
        log: output/oac_log/flow_chart_general_population.log

  # Main Analysis 1
  # Objective 1: compare AF treated people with AF non-treated people
  format_dataset_af_oac:
    run: stata-mp:latest analysis/00_cr_create_analysis_dataset.do af_oac input_af
    needs: [generate_cohort]
    outputs:
      moderately_sensitive:
        log: output/oac_log/00_cr_create_analysis_dataset.log
      highly_sensitive:
        data: "output/oac_tempdata/format_dataset.dta"

  create_dataset_af_oac:
    run: stata-mp:latest analysis/01_cr_create_exposure_outcome_af.do af_oac
    needs: [format_dataset_af_oac]
    outputs:
      moderately_sensitive:
        log: output/oac_log/01_cr_create_exposure_outcome_af.log
      highly_sensitive:
        data: "output/oac_tempdata/cr_dataset_af.dta"

  # Export case dataset for matching
  02ai_exportfile_matching:
    run: stata-mp:latest analysis/02ai_exportfile_matching.do af_oac
    needs: [create_dataset_af_oac]
    outputs:
      moderately_sensitive:
        log: output/oac_log/02ai_exportfile_matching.log
      highly_sensitive:
        data1: "output/input_af_oac.csv"
        data2: "output/input_af_oac.dta"
               
  # Primary Outcomes: ONS COVID-19 death
  02aii_cr_create_population_af_oac_onscoviddeath:
    run: stata-mp:latest analysis/02aii_cr_create_population.do onscoviddeath af_oac
    needs: [create_dataset_af_oac]
    outputs:
      moderately_sensitive:
        log: output/oac_log/02aii_cr_create_population_onscoviddeath.log
      highly_sensitive:
        data1: "output/oac_tempdata/analysis_dataset_onscoviddeath.dta"
        data2: "output/oac_tempdata/analysis_dataset_STSET_onscoviddeath.dta"

  03_an_checks_af_oac_onscoviddeath:
    run: stata-mp:latest analysis/03_an_checks.do onscoviddeath af_oac
    needs: [02aii_cr_create_population_af_oac_onscoviddeath]
    outputs:
      moderately_sensitive:
        log: output/oac_log/03_an_checks_onscoviddeath.log
  
  04_an_descriptive_table_af_oac_onscoviddeath:
    run: stata-mp:latest analysis/04_an_descriptive_table.do onscoviddeath af_oac
    needs: [02aii_cr_create_population_af_oac_onscoviddeath]
    outputs:
      moderately_sensitive:
        log: output/oac_log/04_an_descriptive_table_onscoviddeath.log
        table: "output/oac_tabfig/table1_onscoviddeath.txt"

  05a_an_models_af_oac_onscoviddeath:
    run: stata-mp:latest analysis/05a_an_models.do onscoviddeath af_oac
    needs: [02aii_cr_create_population_af_oac_onscoviddeath]
    outputs:
      moderately_sensitive:
        log: output/oac_log/05a_an_models_onscoviddeath.log
        table: "output/oac_tabfig/table2_onscoviddeath.txt"
      highly_sensitive:
        data1: "output/oac_tempdata/onscoviddeath_univar.ster"
        data2: "output/oac_tempdata/onscoviddeath_multivar1.ster"
        data3: "output/oac_tempdata/onscoviddeath_multivar2.ster"
        data4: "output/oac_tempdata/onscoviddeath_multivar3.ster"

  06a_an_models_ethnicity_af_oac_onscoviddeath:
    run: stata-mp:latest analysis/06a_an_models_ethnicity.do onscoviddeath af_oac
    needs: [02aii_cr_create_population_af_oac_onscoviddeath]
    outputs:
      moderately_sensitive:
        log: output/oac_log/06a_an_models_ethnicity_onscoviddeath.log
        table: "output/oac_tabfig/table3_onscoviddeath.txt"
      highly_sensitive:
        data1: "output/oac_tempdata/onscoviddeath_univar_ethn.ster"
        data2: "output/oac_tempdata/onscoviddeath_multivar1_ethn.ster"
        data3: "output/oac_tempdata/onscoviddeath_multivar2_ethn.ster"
        data4: "output/oac_tempdata/onscoviddeath_multivar2_withoutethn.ster"
        data5: "output/oac_tempdata/onscoviddeath_multivar3_ethn.ster"
        data6: "output/oac_tempdata/onscoviddeath_multivar3_withoutethn.ster"

  07_an_model_explore_af_oac_onscoviddeath:
    run: stata-mp:latest analysis/07_an_model_explore.do onscoviddeath af_oac
    needs: [02aii_cr_create_population_af_oac_onscoviddeath]
    outputs:
      moderately_sensitive:
        log: output/oac_log/07_an_model_explore_onscoviddeath.log
        table: "output/oac_tabfig/table4_onscoviddeath.txt"

  08a_an_model_checks_af_oac_onscoviddeath:
    run: stata-mp:latest analysis/08a_an_model_checks.do onscoviddeath af_oac
    needs: [02aii_cr_create_population_af_oac_onscoviddeath]
    outputs:
      moderately_sensitive:
        log: output/oac_log/08a_an_model_checks_onscoviddeath.log
        fig1: "output/oac_tabfig/onscoviddeath_schoenplot1.svg"
        fig2: "output/oac_tabfig/onscoviddeath_schoenplot2.svg"
        fig3: "output/oac_tabfig/onscoviddeath_schoenplot3.svg"
        fig4: "output/oac_tabfig/onscoviddeath_schoenplot4.svg"
        table1: "output/oac_tabfig/table5_onscoviddeath.txt"
        fig5: "output/oac_tabfig/onscoviddeath_schoenplot1_completecase.svg"
        fig6: "output/oac_tabfig/onscoviddeath_schoenplot2_completecase.svg"
        fig7: "output/oac_tabfig/onscoviddeath_schoenplot3_completecase_ethn.svg"
        fig8: "output/oac_tabfig/onscoviddeath_schoenplot3_completecase.svg"
        fig9: "output/oac_tabfig/onscoviddeath_schoenplot4_completecase_ethn.svg"
        fig10: "output/oac_tabfig/onscoviddeath_schoenplot4_completecase.svg"
        table2: "output/oac_tabfig/table6_onscoviddeath.txt"

  09a_an_models_plot_af_oac_onscoviddeath:
    run: stata-mp:latest analysis/09a_an_models_plot.do onscoviddeath af_oac 3 0.5 0.1
    needs: [02aii_cr_create_population_af_oac_onscoviddeath]
    outputs:
      moderately_sensitive:
        log: output/oac_log/09a_an_models_plot_onscoviddeath.log
        fig1: "output/oac_tabfig/adj_curves_onscoviddeath.svg"
        fig2: "output/oac_tabfig/diff_curves_onscoviddeath.svg"

  # Primary Outcomes: COVID-19 hospital admission
  02aii_cr_create_population_af_oac_admitcovid:
    run: stata-mp:latest analysis/02aii_cr_create_population.do admitcovid af_oac
    needs: [create_dataset_af_oac]
    outputs:
      moderately_sensitive:
        log: output/oac_log/02aii_cr_create_population_admitcovid.log
      highly_sensitive:
        data1: "output/oac_tempdata/analysis_dataset_admitcovid.dta"
        data2: "output/oac_tempdata/analysis_dataset_STSET_admitcovid.dta"

  03_an_checks_af_oac_admitcovid:
    run: stata-mp:latest analysis/03_an_checks.do admitcovid af_oac
    needs: [02aii_cr_create_population_af_oac_admitcovid]
    outputs:
      moderately_sensitive:
        log: output/oac_log/03_an_checks_admitcovid.log

  05a_an_models_af_oac_admitcovid:
    run: stata-mp:latest analysis/05a_an_models.do admitcovid af_oac
    needs: [02aii_cr_create_population_af_oac_admitcovid]
    outputs:
      moderately_sensitive:
        log: output/oac_log/05a_an_models_admitcovid.log
        table: "output/oac_tabfig/table2_admitcovid.txt"
      highly_sensitive:
        data1: "output/oac_tempdata/admitcovid_univar.ster"
        data2: "output/oac_tempdata/admitcovid_multivar1.ster"
        data3: "output/oac_tempdata/admitcovid_multivar2.ster"
        data4: "output/oac_tempdata/admitcovid_multivar3.ster"

  06a_an_models_ethnicity_af_oac_admitcovid:
    run: stata-mp:latest analysis/06a_an_models_ethnicity.do admitcovid af_oac
    needs: [02aii_cr_create_population_af_oac_admitcovid]
    outputs:
      moderately_sensitive:
        log: output/oac_log/06a_an_models_ethnicity_admitcovid.log
        table: "output/oac_tabfig/table3_admitcovid.txt"
      highly_sensitive:
        data1: "output/oac_tempdata/admitcovid_univar_ethn.ster"
        data2: "output/oac_tempdata/admitcovid_multivar1_ethn.ster"
        data3: "output/oac_tempdata/admitcovid_multivar2_ethn.ster"
        data4: "output/oac_tempdata/admitcovid_multivar2_withoutethn.ster"
        data5: "output/oac_tempdata/admitcovid_multivar3_ethn.ster"
        data6: "output/oac_tempdata/admitcovid_multivar3_withoutethn.ster"

  07_an_model_explore_af_oac_admitcovid:
    run: stata-mp:latest analysis/07_an_model_explore.do admitcovid af_oac
    needs: [02aii_cr_create_population_af_oac_admitcovid]
    outputs:
      moderately_sensitive:
        log: output/oac_log/07_an_model_explore_admitcovid.log
        table: "output/oac_tabfig/table4_admitcovid.txt"

  08a_an_model_checks_af_oac_admitcovid:
    run: stata-mp:latest analysis/08a_an_model_checks.do admitcovid af_oac
    needs: [02aii_cr_create_population_af_oac_admitcovid]
    outputs:
      moderately_sensitive:
        log: output/oac_log/08a_an_model_checks_admitcovid.log
        fig1: "output/oac_tabfig/admitcovid_schoenplot1.svg"
        fig2: "output/oac_tabfig/admitcovid_schoenplot2.svg"
        fig3: "output/oac_tabfig/admitcovid_schoenplot3.svg"
        fig4: "output/oac_tabfig/admitcovid_schoenplot4.svg"
        table1: "output/oac_tabfig/table5_admitcovid.txt"
        fig5: "output/oac_tabfig/admitcovid_schoenplot1_completecase.svg"
        fig6: "output/oac_tabfig/admitcovid_schoenplot2_completecase.svg"
        fig7: "output/oac_tabfig/admitcovid_schoenplot3_completecase_ethn.svg"
        fig8: "output/oac_tabfig/admitcovid_schoenplot3_completecase.svg"
        fig9: "output/oac_tabfig/admitcovid_schoenplot4_completecase_ethn.svg"
        fig10: "output/oac_tabfig/admitcovid_schoenplot4_completecase.svg"
        table2: "output/oac_tabfig/table6_admitcovid.txt"

  09a_an_models_plot_af_oac_admitcovid:
    run: stata-mp:latest analysis/09a_an_models_plot.do admitcovid af_oac 2 0.5 0.1
    needs: [02aii_cr_create_population_af_oac_admitcovid]
    outputs:
      moderately_sensitive:
        log: output/oac_log/09a_an_models_plot_admitcovid.log
        fig1: "output/oac_tabfig/adj_curves_admitcovid.svg"
        fig2: "output/oac_tabfig/diff_curves_admitcovid.svg"

  # Exploratory Outcomes: COVID-19 test
  02aii_cr_create_population_af_oac_covidtest:
    run: stata-mp:latest analysis/02aii_cr_create_population.do covidtest af_oac
    needs: [create_dataset_af_oac]
    outputs:
      moderately_sensitive:
        log: output/oac_log/02aii_cr_create_population_covidtest.log
      highly_sensitive:
        data1: "output/oac_tempdata/analysis_dataset_covidtest.dta"
        data2: "output/oac_tempdata/analysis_dataset_STSET_covidtest.dta"

  03_an_checks_af_oac_covidtest:
    run: stata-mp:latest analysis/03_an_checks.do covidtest af_oac
    needs: [02aii_cr_create_population_af_oac_covidtest]
    outputs:
      moderately_sensitive:
        log: output/oac_log/03_an_checks_covidtest.log

  05a_an_models_af_oac_covidtest:
    run: stata-mp:latest analysis/05a_an_models.do covidtest af_oac
    needs: [02aii_cr_create_population_af_oac_covidtest]
    outputs:
      moderately_sensitive:
        log: output/oac_log/05a_an_models_covidtest.log
        table: "output/oac_tabfig/table2_covidtest.txt"
      highly_sensitive:
        data1: "output/oac_tempdata/covidtest_univar.ster"
        data2: "output/oac_tempdata/covidtest_multivar1.ster"
        data3: "output/oac_tempdata/covidtest_multivar2.ster"
        data4: "output/oac_tempdata/covidtest_multivar3.ster"

  06a_an_models_ethnicity_af_oac_covidtest:
    run: stata-mp:latest analysis/06a_an_models_ethnicity.do covidtest af_oac
    needs: [02aii_cr_create_population_af_oac_covidtest]
    outputs:
      moderately_sensitive:
        log: output/oac_log/06a_an_models_ethnicity_covidtest.log
        table: "output/oac_tabfig/table3_covidtest.txt"
      highly_sensitive:
        data1: "output/oac_tempdata/covidtest_univar_ethn.ster"
        data2: "output/oac_tempdata/covidtest_multivar1_ethn.ster"
        data3: "output/oac_tempdata/covidtest_multivar2_ethn.ster"
        data4: "output/oac_tempdata/covidtest_multivar2_withoutethn.ster"
        data5: "output/oac_tempdata/covidtest_multivar3_ethn.ster"
        data6: "output/oac_tempdata/covidtest_multivar3_withoutethn.ster"

  08a_an_model_checks_af_oac_covidtest:
    run: stata-mp:latest analysis/08a_an_model_checks.do covidtest af_oac
    needs: [02aii_cr_create_population_af_oac_covidtest]
    outputs:
      moderately_sensitive:
        log: output/oac_log/08a_an_model_checks_covidtest.log
        fig1: "output/oac_tabfig/covidtest_schoenplot1.svg"
        fig2: "output/oac_tabfig/covidtest_schoenplot2.svg"
        fig3: "output/oac_tabfig/covidtest_schoenplot3.svg"
        fig4: "output/oac_tabfig/covidtest_schoenplot4.svg"
        table1: "output/oac_tabfig/table5_covidtest.txt"
        fig5: "output/oac_tabfig/covidtest_schoenplot1_completecase.svg"
        fig6: "output/oac_tabfig/covidtest_schoenplot2_completecase.svg"
        fig7: "output/oac_tabfig/covidtest_schoenplot3_completecase_ethn.svg"
        fig8: "output/oac_tabfig/covidtest_schoenplot3_completecase.svg"
        fig9: "output/oac_tabfig/covidtest_schoenplot4_completecase_ethn.svg"
        fig10: "output/oac_tabfig/covidtest_schoenplot4_completecase.svg"
        table2: "output/oac_tabfig/table6_covidtest.txt"

  09a_an_models_plot_af_oac_covidtest:
    run: stata-mp:latest analysis/09a_an_models_plot.do covidtest af_oac 3 20 1
    needs: [02aii_cr_create_population_af_oac_covidtest]
    outputs:
      moderately_sensitive:
        log: output/oac_log/09a_an_models_plot_covidtest.log
        fig1: "output/oac_tabfig/adj_curves_covidtest.svg"
        fig2: "output/oac_tabfig/diff_curves_covidtest.svg"

  # Exploratory Outcomes: Positive COVID test
  02aii_cr_create_population_af_oac_positivecovidtest:
    run: stata-mp:latest analysis/02aii_cr_create_population.do positivecovidtest af_oac
    needs: [create_dataset_af_oac]
    outputs:
      moderately_sensitive:
        log: output/oac_log/02aii_cr_create_population_positivecovidtest.log
      highly_sensitive:
        data1: "output/oac_tempdata/analysis_dataset_positivecovidtest.dta"
        data2: "output/oac_tempdata/analysis_dataset_STSET_positivecovidtest.dta"

  03_an_checks_af_oac_positivecovidtest:
    run: stata-mp:latest analysis/03_an_checks.do positivecovidtest af_oac
    needs: [02aii_cr_create_population_af_oac_positivecovidtest]
    outputs:
      moderately_sensitive:
        log: output/oac_log/03_an_checks_positivecovidtest.log

  05a_an_models_af_oac_positivecovidtest:
    run: stata-mp:latest analysis/05a_an_models.do positivecovidtest af_oac
    needs: [02aii_cr_create_population_af_oac_positivecovidtest]
    outputs:
      moderately_sensitive:
        log: output/oac_log/05a_an_models_positivecovidtest.log
        table: "output/oac_tabfig/table2_positivecovidtest.txt"
      highly_sensitive:
        data1: "output/oac_tempdata/positivecovidtest_univar.ster"
        data2: "output/oac_tempdata/positivecovidtest_multivar1.ster"
        data3: "output/oac_tempdata/positivecovidtest_multivar2.ster"
        data4: "output/oac_tempdata/positivecovidtest_multivar3.ster"

  06a_an_models_ethnicity_af_oac_positivecovidtest:
    run: stata-mp:latest analysis/06a_an_models_ethnicity.do positivecovidtest af_oac
    needs: [02aii_cr_create_population_af_oac_positivecovidtest]
    outputs:
      moderately_sensitive:
        log: output/oac_log/06a_an_models_ethnicity_positivecovidtest.log
        table: "output/oac_tabfig/table3_positivecovidtest.txt"
      highly_sensitive:
        data1: "output/oac_tempdata/positivecovidtest_univar_ethn.ster"
        data2: "output/oac_tempdata/positivecovidtest_multivar1_ethn.ster"
        data3: "output/oac_tempdata/positivecovidtest_multivar2_ethn.ster"
        data4: "output/oac_tempdata/positivecovidtest_multivar2_withoutethn.ster"
        data5: "output/oac_tempdata/positivecovidtest_multivar3_ethn.ster"
        data6: "output/oac_tempdata/positivecovidtest_multivar3_withoutethn.ster"

  08a_an_model_checks_af_oac_positivecovidtest:
    run: stata-mp:latest analysis/08a_an_model_checks.do positivecovidtest af_oac
    needs: [02aii_cr_create_population_af_oac_positivecovidtest]
    outputs:
      moderately_sensitive:
        log: output/oac_log/08a_an_model_checks_positivecovidtest.log
        fig1: "output/oac_tabfig/positivecovidtest_schoenplot1.svg"
        fig2: "output/oac_tabfig/positivecovidtest_schoenplot2.svg"
        fig3: "output/oac_tabfig/positivecovidtest_schoenplot3.svg"
        fig4: "output/oac_tabfig/positivecovidtest_schoenplot4.svg"
        table1: "output/oac_tabfig/table5_positivecovidtest.txt"
        fig5: "output/oac_tabfig/positivecovidtest_schoenplot1_completecase.svg"
        fig6: "output/oac_tabfig/positivecovidtest_schoenplot2_completecase.svg"
        fig7: "output/oac_tabfig/positivecovidtest_schoenplot3_completecase_ethn.svg"
        fig8: "output/oac_tabfig/positivecovidtest_schoenplot3_completecase.svg"
        fig9: "output/oac_tabfig/positivecovidtest_schoenplot4_completecase_ethn.svg"
        fig10: "output/oac_tabfig/positivecovidtest_schoenplot4_completecase.svg"
        table2: "output/oac_tabfig/table6_positivecovidtest.txt"

  09a_an_models_plot_af_oac_positivecovidtest:
    run: stata-mp:latest analysis/09a_an_models_plot.do positivecovidtest af_oac 3 2 0.5
    needs: [02aii_cr_create_population_af_oac_positivecovidtest]
    outputs:
      moderately_sensitive:
        log: output/oac_log/09a_an_models_plot_positivecovidtest.log
        fig1: "output/oac_tabfig/adj_curves_positivecovidtest.svg"
        fig2: "output/oac_tabfig/diff_curves_positivecovidtest.svg"

  11a_an_models_af_oac:
    run: stata-mp:latest analysis/11a_an_models.do af_oac
    needs: [02aii_cr_create_population_af_oac_positivecovidtest]
    outputs:
      moderately_sensitive:
        log: output/oac_log/11a_an_models.log
        table: "output/oac_tabfig/table8.txt"
      highly_sensitive:
        data1: "output/oac_tempdata/11a_admitcovid_multivar2.ster"
        data2: "output/oac_tempdata/11a_admitcovid_multivar3.ster"
        data3: "output/oac_tempdata/11a_onscoviddeath_multivar2.ster"
        data4: "output/oac_tempdata/11a_onscoviddeath_multivar3.ster"

  # Main Analysis 2
  # Objective 2: Compare warfarin users and DOAC users
  format_dataset_af_warfarin:
    run: stata-mp:latest analysis/00_cr_create_analysis_dataset.do af_warfarin input_af
    needs: [generate_cohort]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/00_cr_create_analysis_dataset.log
      highly_sensitive:
        data: "output/warfarin_tempdata/format_dataset.dta"

  create_dataset_af_warfarin:
    run: stata-mp:latest analysis/01_cr_create_exposure_outcome_af.do af_warfarin
    needs: [format_dataset_af_warfarin]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/01_cr_create_exposure_outcome_af.log
      highly_sensitive:
        data: "output/warfarin_tempdata/cr_dataset_af.dta"

  # Primary Outcomes: ONS COVID-19 death
  02b_cr_create_population_af_warfarin_onscoviddeath:
    run: stata-mp:latest analysis/02b_cr_create_population.do onscoviddeath af_warfarin
    needs: [create_dataset_af_warfarin]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/02b_cr_create_population_onscoviddeath.log
      highly_sensitive:
        data1: "output/warfarin_tempdata/analysis_dataset_onscoviddeath.dta"
        data2: "output/warfarin_tempdata/analysis_dataset_STSET_onscoviddeath.dta"

  03_an_checks_af_warfarin_onscoviddeath:
    run: stata-mp:latest analysis/03_an_checks.do onscoviddeath af_warfarin
    needs: [02b_cr_create_population_af_warfarin_onscoviddeath]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/03_an_checks_onscoviddeath.log
  
  04_an_descriptive_table_af_warfarin_onscoviddeath:
    run: stata-mp:latest analysis/04_an_descriptive_table.do onscoviddeath af_warfarin
    needs: [02b_cr_create_population_af_warfarin_onscoviddeath]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/04_an_descriptive_table_onscoviddeath.log
        table: "output/warfarin_tabfig/table1_onscoviddeath.txt"

  05b_an_models_af_warfarin_onscoviddeath:
    run: stata-mp:latest analysis/05b_an_models.do onscoviddeath af_warfarin
    needs: [02b_cr_create_population_af_warfarin_onscoviddeath]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/05b_an_models_onscoviddeath.log
        table: "output/warfarin_tabfig/table2_onscoviddeath.txt"
      highly_sensitive:
        data1: "output/warfarin_tempdata/onscoviddeath_univar.ster"
        data2: "output/warfarin_tempdata/onscoviddeath_multivar1.ster"
        data3: "output/warfarin_tempdata/onscoviddeath_multivar2.ster"
        data4: "output/warfarin_tempdata/onscoviddeath_multivar3.ster"

  06b_an_models_ethnicity_af_warfarin_onscoviddeath:
    run: stata-mp:latest analysis/06b_an_models_ethnicity.do onscoviddeath af_warfarin
    needs: [02b_cr_create_population_af_warfarin_onscoviddeath]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/06b_an_models_ethnicity_onscoviddeath.log
        table: "output/warfarin_tabfig/table3_onscoviddeath.txt"
      highly_sensitive:
        data1: "output/warfarin_tempdata/onscoviddeath_univar_ethn.ster"
        data2: "output/warfarin_tempdata/onscoviddeath_multivar1_ethn.ster"
        data3: "output/warfarin_tempdata/onscoviddeath_multivar2_ethn.ster"
        data4: "output/warfarin_tempdata/onscoviddeath_multivar2_withoutethn.ster"
        data5: "output/warfarin_tempdata/onscoviddeath_multivar3_ethn.ster"
        data6: "output/warfarin_tempdata/onscoviddeath_multivar3_withoutethn.ster"

  07_an_model_explore_af_warfarin_onscoviddeath:
    run: stata-mp:latest analysis/07_an_model_explore.do onscoviddeath af_warfarin
    needs: [02b_cr_create_population_af_warfarin_onscoviddeath]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/07_an_model_explore_onscoviddeath.log
        table: "output/warfarin_tabfig/table4_onscoviddeath.txt"

  08b_an_model_checks_af_warfarin_onscoviddeath:
    run: stata-mp:latest analysis/08b_an_model_checks.do onscoviddeath af_warfarin
    needs: [02b_cr_create_population_af_warfarin_onscoviddeath]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/08b_an_model_checks_onscoviddeath.log
        fig1: "output/warfarin_tabfig/onscoviddeath_schoenplot1.svg"
        fig2: "output/warfarin_tabfig/onscoviddeath_schoenplot2.svg"
        fig3: "output/warfarin_tabfig/onscoviddeath_schoenplot3.svg"
        fig4: "output/warfarin_tabfig/onscoviddeath_schoenplot4.svg"
        table1: "output/warfarin_tabfig/table5_onscoviddeath.txt"
        fig5: "output/warfarin_tabfig/onscoviddeath_schoenplot1_completecase.svg"
        fig6: "output/warfarin_tabfig/onscoviddeath_schoenplot2_completecase.svg"
        fig7: "output/warfarin_tabfig/onscoviddeath_schoenplot3_completecase_ethn.svg"
        fig8: "output/warfarin_tabfig/onscoviddeath_schoenplot3_completecase.svg"
        fig9: "output/warfarin_tabfig/onscoviddeath_schoenplot4_completecase_ethn.svg"
        fig10: "output/warfarin_tabfig/onscoviddeath_schoenplot4_completecase.svg"
        table2: "output/warfarin_tabfig/table6_onscoviddeath.txt"

  09b_an_models_plot_af_warfarin_onscoviddeath:
    run: stata-mp:latest analysis/09b_an_models_plot.do onscoviddeath af_warfarin 2 1 0.1
    needs: [02b_cr_create_population_af_warfarin_onscoviddeath]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/09b_an_models_plot_onscoviddeath.log
        fig1: "output/warfarin_tabfig/adj_curves_onscoviddeath.svg"
        fig2: "output/warfarin_tabfig/diff_curves_onscoviddeath.svg"

  # Primary Outcomes: COVID-19 hospital admission
  02b_cr_create_population_af_warfarin_admitcovid:
    run: stata-mp:latest analysis/02b_cr_create_population.do admitcovid af_warfarin
    needs: [create_dataset_af_warfarin]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/02b_cr_create_population_admitcovid.log
      highly_sensitive:
        data1: "output/warfarin_tempdata/analysis_dataset_admitcovid.dta"
        data2: "output/warfarin_tempdata/analysis_dataset_STSET_admitcovid.dta"

  03_an_checks_af_warfarin_admitcovid:
    run: stata-mp:latest analysis/03_an_checks.do admitcovid af_warfarin
    needs: [02b_cr_create_population_af_warfarin_admitcovid]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/03_an_checks_admitcovid.log

  05b_an_models_af_warfarin_admitcovid:
    run: stata-mp:latest analysis/05b_an_models.do admitcovid af_warfarin
    needs: [02b_cr_create_population_af_warfarin_admitcovid]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/05b_an_models_admitcovid.log
        table: "output/warfarin_tabfig/table2_admitcovid.txt"
      highly_sensitive:
        data1: "output/warfarin_tempdata/admitcovid_univar.ster"
        data2: "output/warfarin_tempdata/admitcovid_multivar1.ster"
        data3: "output/warfarin_tempdata/admitcovid_multivar2.ster"
        data4: "output/warfarin_tempdata/admitcovid_multivar3.ster"

  06b_an_models_ethnicity_af_warfarin_admitcovid:
    run: stata-mp:latest analysis/06b_an_models_ethnicity.do admitcovid af_warfarin
    needs: [02b_cr_create_population_af_warfarin_admitcovid]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/06b_an_models_ethnicity_admitcovid.log
        table: "output/warfarin_tabfig/table3_admitcovid.txt"
      highly_sensitive:
        data1: "output/warfarin_tempdata/admitcovid_univar_ethn.ster"
        data2: "output/warfarin_tempdata/admitcovid_multivar1_ethn.ster"
        data3: "output/warfarin_tempdata/admitcovid_multivar2_ethn.ster"
        data4: "output/warfarin_tempdata/admitcovid_multivar2_withoutethn.ster"
        data5: "output/warfarin_tempdata/admitcovid_multivar3_ethn.ster"
        data6: "output/warfarin_tempdata/admitcovid_multivar3_withoutethn.ster"

  07_an_model_explore_af_warfarin_admitcovid:
    run: stata-mp:latest analysis/07_an_model_explore.do admitcovid af_warfarin
    needs: [02b_cr_create_population_af_warfarin_admitcovid]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/07_an_model_explore_admitcovid.log
        table: "output/warfarin_tabfig/table4_admitcovid.txt"

  08b_an_model_checks_af_warfarin_admitcovid:
    run: stata-mp:latest analysis/08b_an_model_checks.do admitcovid af_warfarin
    needs: [02b_cr_create_population_af_warfarin_admitcovid]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/08b_an_model_checks_admitcovid.log
        fig1: "output/warfarin_tabfig/admitcovid_schoenplot1.svg"
        fig2: "output/warfarin_tabfig/admitcovid_schoenplot2.svg"
        fig3: "output/warfarin_tabfig/admitcovid_schoenplot3.svg"
        fig4: "output/warfarin_tabfig/admitcovid_schoenplot4.svg"
        table1: "output/warfarin_tabfig/table5_admitcovid.txt"
        fig5: "output/warfarin_tabfig/admitcovid_schoenplot1_completecase.svg"
        fig6: "output/warfarin_tabfig/admitcovid_schoenplot2_completecase.svg"
        fig7: "output/warfarin_tabfig/admitcovid_schoenplot3_completecase_ethn.svg"
        fig8: "output/warfarin_tabfig/admitcovid_schoenplot3_completecase.svg"
        fig9: "output/warfarin_tabfig/admitcovid_schoenplot4_completecase_ethn.svg"
        fig10: "output/warfarin_tabfig/admitcovid_schoenplot4_completecase.svg"
        table2: "output/warfarin_tabfig/table6_admitcovid.txt"

  09b_an_models_plot_af_warfarin_admitcovid:
    run: stata-mp:latest analysis/09b_an_models_plot.do admitcovid af_warfarin 2 1 0.1
    needs: [02b_cr_create_population_af_warfarin_admitcovid]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/09b_an_models_plot_admitcovid.log
        fig1: "output/warfarin_tabfig/adj_curves_admitcovid.svg"
        fig2: "output/warfarin_tabfig/diff_curves_admitcovid.svg"

    # Exploratory Outcomes: Non-COVID death
  02b_cr_create_population_af_warfarin_onsnoncoviddeath:
    run: stata-mp:latest analysis/02b_cr_create_population.do onsnoncoviddeath af_warfarin
    needs: [create_dataset_af_warfarin]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/02b_cr_create_population_onsnoncoviddeath.log
      highly_sensitive:
        data1: "output/warfarin_tempdata/analysis_dataset_onsnoncoviddeath.dta"
        data2: "output/warfarin_tempdata/analysis_dataset_STSET_onsnoncoviddeath.dta"

  03_an_checks_af_warfarin_onsnoncoviddeath:
    run: stata-mp:latest analysis/03_an_checks.do onsnoncoviddeath af_warfarin
    needs: [02b_cr_create_population_af_warfarin_onsnoncoviddeath]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/03_an_checks_onsnoncoviddeath.log

  05b_an_models_af_warfarin_onsnoncoviddeath:
    run: stata-mp:latest analysis/05b_an_models.do onsnoncoviddeath af_warfarin
    needs: [02b_cr_create_population_af_warfarin_onsnoncoviddeath]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/05b_an_models_onsnoncoviddeath.log
        table: "output/warfarin_tabfig/table2_onsnoncoviddeath.txt"
      highly_sensitive:
        data1: "output/warfarin_tempdata/onsnoncoviddeath_univar.ster"
        data2: "output/warfarin_tempdata/onsnoncoviddeath_multivar1.ster"
        data3: "output/warfarin_tempdata/onsnoncoviddeath_multivar2.ster"
        data4: "output/warfarin_tempdata/onsnoncoviddeath_multivar3.ster"

  06b_an_models_ethnicity_af_warfarin_onsnoncoviddeath:
    run: stata-mp:latest analysis/06b_an_models_ethnicity.do onsnoncoviddeath af_warfarin
    needs: [02b_cr_create_population_af_warfarin_onsnoncoviddeath]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/06b_an_models_ethnicity_onsnoncoviddeath.log
        table: "output/warfarin_tabfig/table3_onsnoncoviddeath.txt"
      highly_sensitive:
        data1: "output/warfarin_tempdata/onsnoncoviddeath_univar_ethn.ster"
        data2: "output/warfarin_tempdata/onsnoncoviddeath_multivar1_ethn.ster"
        data3: "output/warfarin_tempdata/onsnoncoviddeath_multivar2_ethn.ster"
        data4: "output/warfarin_tempdata/onsnoncoviddeath_multivar2_withoutethn.ster"
        data5: "output/warfarin_tempdata/onsnoncoviddeath_multivar3_ethn.ster"
        data6: "output/warfarin_tempdata/onsnoncoviddeath_multivar3_withoutethn.ster"

  08b_an_model_checks_af_warfarin_onsnoncoviddeath:
    run: stata-mp:latest analysis/08b_an_model_checks.do onsnoncoviddeath af_warfarin
    needs: [02b_cr_create_population_af_warfarin_onsnoncoviddeath]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/08b_an_model_checks_onsnoncoviddeath.log
        fig1: "output/warfarin_tabfig/onsnoncoviddeath_schoenplot1.svg"
        fig2: "output/warfarin_tabfig/onsnoncoviddeath_schoenplot2.svg"
        fig3: "output/warfarin_tabfig/onsnoncoviddeath_schoenplot3.svg"
        fig4: "output/warfarin_tabfig/onsnoncoviddeath_schoenplot4.svg"
        table1: "output/warfarin_tabfig/table5_onsnoncoviddeath.txt"
        fig5: "output/warfarin_tabfig/onsnoncoviddeath_schoenplot1_completecase.svg"
        fig6: "output/warfarin_tabfig/onsnoncoviddeath_schoenplot2_completecase.svg"
        fig7: "output/warfarin_tabfig/onsnoncoviddeath_schoenplot3_completecase_ethn.svg"
        fig8: "output/warfarin_tabfig/onsnoncoviddeath_schoenplot3_completecase.svg"
        fig9: "output/warfarin_tabfig/onsnoncoviddeath_schoenplot4_completecase_ethn.svg"
        fig10: "output/warfarin_tabfig/onsnoncoviddeath_schoenplot4_completecase.svg"
        table2: "output/warfarin_tabfig/table6_onsnoncoviddeath.txt"

  09b_an_models_plot_af_warfarin_onsnoncoviddeath:
    run: stata-mp:latest analysis/09b_an_models_plot.do onsnoncoviddeath af_warfarin 3 5 1
    needs: [02b_cr_create_population_af_warfarin_onsnoncoviddeath]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/09b_an_models_plot_onsnoncoviddeath.log
        fig1: "output/warfarin_tabfig/adj_curves_onsnoncoviddeath.svg"
        fig2: "output/warfarin_tabfig/diff_curves_onsnoncoviddeath.svg"
        
  # Exploratory Outcomes: COVID-19 test
  02b_cr_create_population_af_warfarin_covidtest:
    run: stata-mp:latest analysis/02b_cr_create_population.do covidtest af_warfarin
    needs: [create_dataset_af_warfarin]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/02b_cr_create_population_covidtest.log
      highly_sensitive:
        data1: "output/warfarin_tempdata/analysis_dataset_covidtest.dta"
        data2: "output/warfarin_tempdata/analysis_dataset_STSET_covidtest.dta"

  03_an_checks_af_warfarin_covidtest:
    run: stata-mp:latest analysis/03_an_checks.do covidtest af_warfarin
    needs: [02b_cr_create_population_af_warfarin_covidtest]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/03_an_checks_covidtest.log

  05b_an_models_af_warfarin_covidtest:
    run: stata-mp:latest analysis/05b_an_models.do covidtest af_warfarin
    needs: [02b_cr_create_population_af_warfarin_covidtest]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/05b_an_models_covidtest.log
        table: "output/warfarin_tabfig/table2_covidtest.txt"
      highly_sensitive:
        data1: "output/warfarin_tempdata/covidtest_univar.ster"
        data2: "output/warfarin_tempdata/covidtest_multivar1.ster"
        data3: "output/warfarin_tempdata/covidtest_multivar2.ster"
        data4: "output/warfarin_tempdata/covidtest_multivar3.ster"

  06b_an_models_ethnicity_af_warfarin_covidtest:
    run: stata-mp:latest analysis/06b_an_models_ethnicity.do covidtest af_warfarin
    needs: [02b_cr_create_population_af_warfarin_covidtest]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/06b_an_models_ethnicity_covidtest.log
        table: "output/warfarin_tabfig/table3_covidtest.txt"
      highly_sensitive:
        data1: "output/warfarin_tempdata/covidtest_univar_ethn.ster"
        data2: "output/warfarin_tempdata/covidtest_multivar1_ethn.ster"
        data3: "output/warfarin_tempdata/covidtest_multivar2_ethn.ster"
        data4: "output/warfarin_tempdata/covidtest_multivar2_withoutethn.ster"
        data5: "output/warfarin_tempdata/covidtest_multivar3_ethn.ster"
        data6: "output/warfarin_tempdata/covidtest_multivar3_withoutethn.ster"

  08b_an_model_checks_af_warfarin_covidtest:
    run: stata-mp:latest analysis/08b_an_model_checks.do covidtest af_warfarin
    needs: [02b_cr_create_population_af_warfarin_covidtest]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/08b_an_model_checks_covidtest.log
        fig1: "output/warfarin_tabfig/covidtest_schoenplot1.svg"
        fig2: "output/warfarin_tabfig/covidtest_schoenplot2.svg"
        fig3: "output/warfarin_tabfig/covidtest_schoenplot3.svg"
        fig4: "output/warfarin_tabfig/covidtest_schoenplot4.svg"
        table1: "output/warfarin_tabfig/table5_covidtest.txt"
        fig5: "output/warfarin_tabfig/covidtest_schoenplot1_completecase.svg"
        fig6: "output/warfarin_tabfig/covidtest_schoenplot2_completecase.svg"
        fig7: "output/warfarin_tabfig/covidtest_schoenplot3_completecase_ethn.svg"
        fig8: "output/warfarin_tabfig/covidtest_schoenplot3_completecase.svg"
        fig9: "output/warfarin_tabfig/covidtest_schoenplot4_completecase_ethn.svg"
        fig10: "output/warfarin_tabfig/covidtest_schoenplot4_completecase.svg"
        table2: "output/warfarin_tabfig/table6_covidtest.txt"

  09b_an_models_plot_af_warfarin_covidtest:
    run: stata-mp:latest analysis/09b_an_models_plot.do covidtest af_warfarin 3 30 1
    needs: [02b_cr_create_population_af_warfarin_covidtest]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/09b_an_models_plot_covidtest.log
        fig1: "output/warfarin_tabfig/adj_curves_covidtest.svg"
        fig2: "output/warfarin_tabfig/diff_curves_covidtest.svg"

  # Exploratory Outcomes: Positive COVID test
  02b_cr_create_population_af_warfarin_positivecovidtest:
    run: stata-mp:latest analysis/02b_cr_create_population.do positivecovidtest af_warfarin
    needs: [create_dataset_af_warfarin]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/02b_cr_create_population_positivecovidtest.log
      highly_sensitive:
        data1: "output/warfarin_tempdata/analysis_dataset_positivecovidtest.dta"
        data2: "output/warfarin_tempdata/analysis_dataset_STSET_positivecovidtest.dta"

  03_an_checks_af_warfarin_positivecovidtest:
    run: stata-mp:latest analysis/03_an_checks.do positivecovidtest af_warfarin
    needs: [02b_cr_create_population_af_warfarin_positivecovidtest]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/03_an_checks_positivecovidtest.log

  05b_an_models_af_warfarin_positivecovidtest:
    run: stata-mp:latest analysis/05b_an_models.do positivecovidtest af_warfarin
    needs: [02b_cr_create_population_af_warfarin_positivecovidtest]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/05b_an_models_positivecovidtest.log
        table: "output/warfarin_tabfig/table2_positivecovidtest.txt"
      highly_sensitive:
        data1: "output/warfarin_tempdata/positivecovidtest_univar.ster"
        data2: "output/warfarin_tempdata/positivecovidtest_multivar1.ster"
        data3: "output/warfarin_tempdata/positivecovidtest_multivar2.ster"
        data4: "output/warfarin_tempdata/positivecovidtest_multivar3.ster"

  06b_an_models_ethnicity_af_warfarin_positivecovidtest:
    run: stata-mp:latest analysis/06b_an_models_ethnicity.do positivecovidtest af_warfarin
    needs: [02b_cr_create_population_af_warfarin_positivecovidtest]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/06b_an_models_ethnicity_positivecovidtest.log
        table: "output/warfarin_tabfig/table3_positivecovidtest.txt"
      highly_sensitive:
        data1: "output/warfarin_tempdata/positivecovidtest_univar_ethn.ster"
        data2: "output/warfarin_tempdata/positivecovidtest_multivar1_ethn.ster"
        data3: "output/warfarin_tempdata/positivecovidtest_multivar2_ethn.ster"
        data4: "output/warfarin_tempdata/positivecovidtest_multivar2_withoutethn.ster"
        data5: "output/warfarin_tempdata/positivecovidtest_multivar3_ethn.ster"
        data6: "output/warfarin_tempdata/positivecovidtest_multivar3_withoutethn.ster"

  08b_an_model_checks_af_warfarin_positivecovidtest:
    run: stata-mp:latest analysis/08b_an_model_checks.do positivecovidtest af_warfarin
    needs: [02b_cr_create_population_af_warfarin_positivecovidtest]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/08b_an_model_checks_positivecovidtest.log
        fig1: "output/warfarin_tabfig/positivecovidtest_schoenplot1.svg"
        fig2: "output/warfarin_tabfig/positivecovidtest_schoenplot2.svg"
        fig3: "output/warfarin_tabfig/positivecovidtest_schoenplot3.svg"
        fig4: "output/warfarin_tabfig/positivecovidtest_schoenplot4.svg"
        table1: "output/warfarin_tabfig/table5_positivecovidtest.txt"
        fig5: "output/warfarin_tabfig/positivecovidtest_schoenplot1_completecase.svg"
        fig6: "output/warfarin_tabfig/positivecovidtest_schoenplot2_completecase.svg"
        fig7: "output/warfarin_tabfig/positivecovidtest_schoenplot3_completecase_ethn.svg"
        fig8: "output/warfarin_tabfig/positivecovidtest_schoenplot3_completecase.svg"
        fig9: "output/warfarin_tabfig/positivecovidtest_schoenplot4_completecase_ethn.svg"
        fig10: "output/warfarin_tabfig/positivecovidtest_schoenplot4_completecase.svg"
        table2: "output/warfarin_tabfig/table6_positivecovidtest.txt"

  09b_an_models_plot_af_warfarin_positivecovidtest:
    run: stata-mp:latest analysis/09b_an_models_plot.do positivecovidtest af_warfarin 2 1.5 0.1
    needs: [02b_cr_create_population_af_warfarin_positivecovidtest]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/09b_an_models_plot_positivecovidtest.log
        fig1: "output/warfarin_tabfig/adj_curves_positivecovidtest.svg"
        fig2: "output/warfarin_tabfig/diff_curves_positivecovidtest.svg"

# Main Analysis 3
# Objective 1: compare AF treated people with general population
  matching:
    run: python:latest python analysis/match_running.py
    needs: [generate_cohort, 02ai_exportfile_matching]
    outputs:
      moderately_sensitive:
        log: output/matching_report_af_gen_pop.txt
      highly_sensitive:
        data1: "output/matched_cases_af_gen_pop.csv"
        data2: "output/matched_matches_af_gen_pop.csv"

  format_dataset_af_match:
    run: stata-mp:latest analysis/00_cr_create_analysis_dataset.do af_match matched_matches_af_gen_pop
    needs: [generate_cohort, matching]
    outputs:
      moderately_sensitive:
        log: output/oac_match_log/00_cr_create_analysis_dataset.log
      highly_sensitive:
        data: "output/oac_match_tempdata/format_dataset.dta"

  create_dataset_af_match:
    run: stata-mp:latest analysis/01c_cr_create_exposure_outcome_af_match.do af_match
    needs: [format_dataset_af_match, matching]
    outputs:
      moderately_sensitive:
        log: output/oac_match_log/01c_cr_create_exposure_outcome_af_match.log
      highly_sensitive:
        data: "output/oac_match_tempdata/cr_dataset_af.dta"

  # Primary Outcomes: ONS COVID-19 death
  02c_cr_create_population_af_match_onscoviddeath:
    run: stata-mp:latest analysis/02c_cr_create_population.do onscoviddeath af_match matched_cases_af_gen_pop
    needs: [create_dataset_af_match, matching, 02ai_exportfile_matching]
    outputs:
      moderately_sensitive:
        log: output/oac_match_log/02c_cr_create_population_onscoviddeath.log
      highly_sensitive:
        data1: "output/oac_match_tempdata/matched_control_onscoviddeath.dta"
        data2: "output/oac_match_tempdata/analysis_dataset_onscoviddeath.dta"
        data3: "output/oac_match_tempdata/analysis_dataset_STSET_onscoviddeath.dta"

  03_an_checks_af_match_onscoviddeath:
    run: stata-mp:latest analysis/03_an_checks.do onscoviddeath af_match
    needs: [02c_cr_create_population_af_match_onscoviddeath]
    outputs:
      moderately_sensitive:
        log: output/oac_match_log/03_an_checks_onscoviddeath.log
  
  04_an_descriptive_table_af_match_onscoviddeath:
    run: stata-mp:latest analysis/04_an_descriptive_table.do onscoviddeath af_match
    needs: [02c_cr_create_population_af_match_onscoviddeath]
    outputs:
      moderately_sensitive:
        log: output/oac_match_log/04_an_descriptive_table_onscoviddeath.log
        table: "output/oac_match_tabfig/table1_onscoviddeath.txt"

  05c_an_models_af_match_onscoviddeath:
    run: stata-mp:latest analysis/05c_an_models.do onscoviddeath af_match
    needs: [02c_cr_create_population_af_match_onscoviddeath]
    outputs:
      moderately_sensitive:
        log: output/oac_match_log/05c_an_models_onscoviddeath.log
        table: "output/oac_match_tabfig/table2_onscoviddeath.txt"
      highly_sensitive:
        data1: "output/oac_match_tempdata/onscoviddeath_univar.ster"
        data2: "output/oac_match_tempdata/onscoviddeath_multivar1.ster"
        data3: "output/oac_match_tempdata/onscoviddeath_multivar2.ster"
        data4: "output/oac_match_tempdata/onscoviddeath_multivar3.ster"

  06c_an_models_ethnicity_af_match_onscoviddeath:
    run: stata-mp:latest analysis/06c_an_models_ethnicity.do onscoviddeath af_match
    needs: [02c_cr_create_population_af_match_onscoviddeath]
    outputs:
      moderately_sensitive:
        log: output/oac_match_log/06c_an_models_ethnicity_onscoviddeath.log
        table: "output/oac_match_tabfig/table3_onscoviddeath.txt"
      highly_sensitive:
        data1: "output/oac_match_tempdata/onscoviddeath_univar_ethn.ster"
        data2: "output/oac_match_tempdata/onscoviddeath_multivar1_ethn.ster"
        data3: "output/oac_match_tempdata/onscoviddeath_multivar2_ethn.ster"
        data4: "output/oac_match_tempdata/onscoviddeath_multivar2_withoutethn.ster"
        data5: "output/oac_match_tempdata/onscoviddeath_multivar3_ethn.ster"
        data6: "output/oac_match_tempdata/onscoviddeath_multivar3_withoutethn.ster"

  07_an_model_explore_af_match_onscoviddeath:
    run: stata-mp:latest analysis/07_an_model_explore.do onscoviddeath af_match
    needs: [02c_cr_create_population_af_match_onscoviddeath]
    outputs:
      moderately_sensitive:
        log: output/oac_match_log/07_an_model_explore_onscoviddeath.log
        table: "output/oac_match_tabfig/table4_onscoviddeath.txt"

  08c_an_model_checks_af_match_onscoviddeath:
    run: stata-mp:latest analysis/08c_an_model_checks.do onscoviddeath af_match
    needs: [02c_cr_create_population_af_match_onscoviddeath]
    outputs:
      moderately_sensitive:
        log: output/oac_match_log/08c_an_model_checks_onscoviddeath.log
        fig1: "output/oac_match_tabfig/onscoviddeath_schoenplot1.svg"
        fig2: "output/oac_match_tabfig/onscoviddeath_schoenplot2.svg"
        fig3: "output/oac_match_tabfig/onscoviddeath_schoenplot3.svg"
        fig4: "output/oac_match_tabfig/onscoviddeath_schoenplot4.svg"
        table1: "output/oac_match_tabfig/table5_onscoviddeath.txt"
        fig5: "output/oac_match_tabfig/onscoviddeath_schoenplot1_completecase.svg"
        fig6: "output/oac_match_tabfig/onscoviddeath_schoenplot2_completecase.svg"
        fig7: "output/oac_match_tabfig/onscoviddeath_schoenplot3_completecase_ethn.svg"
        fig8: "output/oac_match_tabfig/onscoviddeath_schoenplot3_completecase.svg"
        fig9: "output/oac_match_tabfig/onscoviddeath_schoenplot4_completecase_ethn.svg"
        fig10: "output/oac_match_tabfig/onscoviddeath_schoenplot4_completecase.svg"
        table2: "output/oac_match_tabfig/table6_onscoviddeath.txt"

  09a_an_models_plot_af_match_onscoviddeath:
    run: stata-mp:latest analysis/09a_an_models_plot.do onscoviddeath af_match 1 0.5 0.1
    needs: [02c_cr_create_population_af_match_onscoviddeath]
    outputs:
      moderately_sensitive:
        log: output/oac_match_log/09a_an_models_plot_onscoviddeath.log
        fig1: "output/oac_match_tabfig/adj_curves_onscoviddeath.svg"
        fig2: "output/oac_match_tabfig/diff_curves_onscoviddeath.svg"

  # Primary Outcomes: COVID-19 hospital admission
  02c_cr_create_population_af_match_admitcovid:
    run: stata-mp:latest analysis/02c_cr_create_population.do admitcovid af_match matched_cases_af_gen_pop
    needs: [create_dataset_af_match, matching, 02ai_exportfile_matching]
    outputs:
      moderately_sensitive:
        log: output/oac_match_log/02c_cr_create_population_admitcovid.log
      highly_sensitive:
        data1: "output/oac_match_tempdata/matched_control_admitcovid.dta"
        data2: "output/oac_match_tempdata/analysis_dataset_admitcovid.dta"
        data3: "output/oac_match_tempdata/analysis_dataset_STSET_admitcovid.dta"

  03_an_checks_af_match_admitcovid:
    run: stata-mp:latest analysis/03_an_checks.do admitcovid af_match
    needs: [02c_cr_create_population_af_match_admitcovid]
    outputs:
      moderately_sensitive:
        log: output/oac_match_log/03_an_checks_admitcovid.log

  05c_an_models_af_match_admitcovid:
    run: stata-mp:latest analysis/05c_an_models.do admitcovid af_match
    needs: [02c_cr_create_population_af_match_admitcovid]
    outputs:
      moderately_sensitive:
        log: output/oac_match_log/05c_an_models_admitcovid.log
        table: "output/oac_match_tabfig/table2_admitcovid.txt"
      highly_sensitive:
        data1: "output/oac_match_tempdata/admitcovid_univar.ster"
        data2: "output/oac_match_tempdata/admitcovid_multivar1.ster"
        data3: "output/oac_match_tempdata/admitcovid_multivar2.ster"
        data4: "output/oac_match_tempdata/admitcovid_multivar3.ster"

  06c_an_models_ethnicity_af_match_admitcovid:
    run: stata-mp:latest analysis/06c_an_models_ethnicity.do admitcovid af_match
    needs: [02c_cr_create_population_af_match_admitcovid]
    outputs:
      moderately_sensitive:
        log: output/oac_match_log/06c_an_models_ethnicity_admitcovid.log
        table: "output/oac_match_tabfig/table3_admitcovid.txt"
      highly_sensitive:
        data1: "output/oac_match_tempdata/admitcovid_univar_ethn.ster"
        data2: "output/oac_match_tempdata/admitcovid_multivar1_ethn.ster"
        data3: "output/oac_match_tempdata/admitcovid_multivar2_ethn.ster"
        data4: "output/oac_match_tempdata/admitcovid_multivar2_withoutethn.ster"
        data5: "output/oac_match_tempdata/admitcovid_multivar3_ethn.ster"
        data6: "output/oac_match_tempdata/admitcovid_multivar3_withoutethn.ster"

  07_an_model_explore_af_match_admitcovid:
    run: stata-mp:latest analysis/07_an_model_explore.do admitcovid af_match
    needs: [02c_cr_create_population_af_match_admitcovid]
    outputs:
      moderately_sensitive:
        log: output/oac_match_log/07_an_model_explore_admitcovid.log
        table: "output/oac_match_tabfig/table4_admitcovid.txt"

  08c_an_model_checks_af_match_admitcovid:
    run: stata-mp:latest analysis/08c_an_model_checks.do admitcovid af_match
    needs: [02c_cr_create_population_af_match_admitcovid]
    outputs:
      moderately_sensitive:
        log: output/oac_match_log/08c_an_model_checks_admitcovid.log
        fig1: "output/oac_match_tabfig/admitcovid_schoenplot1.svg"
        fig2: "output/oac_match_tabfig/admitcovid_schoenplot2.svg"
        fig3: "output/oac_match_tabfig/admitcovid_schoenplot3.svg"
        fig4: "output/oac_match_tabfig/admitcovid_schoenplot4.svg"
        table1: "output/oac_match_tabfig/table5_admitcovid.txt"
        fig5: "output/oac_match_tabfig/admitcovid_schoenplot1_completecase.svg"
        fig6: "output/oac_match_tabfig/admitcovid_schoenplot2_completecase.svg"
        fig7: "output/oac_match_tabfig/admitcovid_schoenplot3_completecase_ethn.svg"
        fig8: "output/oac_match_tabfig/admitcovid_schoenplot3_completecase.svg"
        fig9: "output/oac_match_tabfig/admitcovid_schoenplot4_completecase_ethn.svg"
        fig10: "output/oac_match_tabfig/admitcovid_schoenplot4_completecase.svg"
        table2: "output/oac_match_tabfig/table6_admitcovid.txt"

  09a_an_models_plot_af_match_admitcovid:
    run: stata-mp:latest analysis/09a_an_models_plot.do admitcovid af_match 2 0.5 0.1
    needs: [02c_cr_create_population_af_match_admitcovid]
    outputs:
      moderately_sensitive:
        log: output/oac_match_log/09a_an_models_plot_admitcovid.log
        fig1: "output/oac_match_tabfig/adj_curves_admitcovid.svg"
        fig2: "output/oac_match_tabfig/diff_curves_admitcovid.svg"

  # Exploratory Outcomes: COVID-19 test
  02c_cr_create_population_af_match_covidtest:
    run: stata-mp:latest analysis/02c_cr_create_population.do covidtest af_match matched_cases_af_gen_pop
    needs: [create_dataset_af_match, matching, 02ai_exportfile_matching]
    outputs:
      moderately_sensitive:
        log: output/oac_match_log/02c_cr_create_population_covidtest.log
      highly_sensitive:
        data1: "output/oac_match_tempdata/matched_control_covidtest.dta"
        data2: "output/oac_match_tempdata/analysis_dataset_covidtest.dta"
        data3: "output/oac_match_tempdata/analysis_dataset_STSET_covidtest.dta"

  03_an_checks_af_match_covidtest:
    run: stata-mp:latest analysis/03_an_checks.do covidtest af_match
    needs: [02c_cr_create_population_af_match_covidtest]
    outputs:
      moderately_sensitive:
        log: output/oac_match_log/03_an_checks_covidtest.log

  05c_an_models_af_match_covidtest:
    run: stata-mp:latest analysis/05c_an_models.do covidtest af_match
    needs: [02c_cr_create_population_af_match_covidtest]
    outputs:
      moderately_sensitive:
        log: output/oac_match_log/05c_an_models_covidtest.log
        table: "output/oac_match_tabfig/table2_covidtest.txt"
      highly_sensitive:
        data1: "output/oac_match_tempdata/covidtest_univar.ster"
        data2: "output/oac_match_tempdata/covidtest_multivar1.ster"
        data3: "output/oac_match_tempdata/covidtest_multivar2.ster"
        data4: "output/oac_match_tempdata/covidtest_multivar3.ster"

  06c_an_models_ethnicity_af_match_covidtest:
    run: stata-mp:latest analysis/06c_an_models_ethnicity.do covidtest af_match
    needs: [02c_cr_create_population_af_match_covidtest]
    outputs:
      moderately_sensitive:
        log: output/oac_match_log/06c_an_models_ethnicity_covidtest.log
        table: "output/oac_match_tabfig/table3_covidtest.txt"
      highly_sensitive:
        data1: "output/oac_match_tempdata/covidtest_univar_ethn.ster"
        data2: "output/oac_match_tempdata/covidtest_multivar1_ethn.ster"
        data3: "output/oac_match_tempdata/covidtest_multivar2_ethn.ster"
        data4: "output/oac_match_tempdata/covidtest_multivar2_withoutethn.ster"
        data5: "output/oac_match_tempdata/covidtest_multivar3_ethn.ster"
        data6: "output/oac_match_tempdata/covidtest_multivar3_withoutethn.ster"

  08c_an_model_checks_af_match_covidtest:
    run: stata-mp:latest analysis/08c_an_model_checks.do covidtest af_match
    needs: [02c_cr_create_population_af_match_covidtest]
    outputs:
      moderately_sensitive:
        log: output/oac_match_log/08c_an_model_checks_covidtest.log
        fig1: "output/oac_match_tabfig/covidtest_schoenplot1.svg"
        fig2: "output/oac_match_tabfig/covidtest_schoenplot2.svg"
        fig3: "output/oac_match_tabfig/covidtest_schoenplot3.svg"
        fig4: "output/oac_match_tabfig/covidtest_schoenplot4.svg"
        table1: "output/oac_match_tabfig/table5_covidtest.txt"
        fig5: "output/oac_match_tabfig/covidtest_schoenplot1_completecase.svg"
        fig6: "output/oac_match_tabfig/covidtest_schoenplot2_completecase.svg"
        fig7: "output/oac_match_tabfig/covidtest_schoenplot3_completecase_ethn.svg"
        fig8: "output/oac_match_tabfig/covidtest_schoenplot3_completecase.svg"
        fig9: "output/oac_match_tabfig/covidtest_schoenplot4_completecase_ethn.svg"
        fig10: "output/oac_match_tabfig/covidtest_schoenplot4_completecase.svg"
        table2: "output/oac_match_tabfig/table6_covidtest.txt"

  09a_an_models_plot_af_match_covidtest:
    run: stata-mp:latest analysis/09a_an_models_plot.do covidtest af_match 3 20 1
    needs: [02c_cr_create_population_af_match_covidtest]
    outputs:
      moderately_sensitive:
        log: output/oac_match_log/09a_an_models_plot_covidtest.log
        fig1: "output/oac_match_tabfig/adj_curves_covidtest.svg"
        fig2: "output/oac_match_tabfig/diff_curves_covidtest.svg"

  # Exploratory Outcomes: Positive COVID test
  02c_cr_create_population_af_match_positivecovidtest:
    run: stata-mp:latest analysis/02c_cr_create_population.do positivecovidtest af_match matched_cases_af_gen_pop
    needs: [create_dataset_af_match, matching, 02ai_exportfile_matching]
    outputs:
      moderately_sensitive:
        log: output/oac_match_log/02c_cr_create_population_positivecovidtest.log
      highly_sensitive:
        data1: "output/oac_match_tempdata/matched_control_positivecovidtest.dta"
        data2: "output/oac_match_tempdata/analysis_dataset_positivecovidtest.dta"
        data3: "output/oac_match_tempdata/analysis_dataset_STSET_positivecovidtest.dta"

  03_an_checks_af_match_positivecovidtest:
    run: stata-mp:latest analysis/03_an_checks.do positivecovidtest af_match
    needs: [02c_cr_create_population_af_match_positivecovidtest]
    outputs:
      moderately_sensitive:
        log: output/oac_match_log/03_an_checks_positivecovidtest.log

  05c_an_models_af_match_positivecovidtest:
    run: stata-mp:latest analysis/05c_an_models.do positivecovidtest af_match
    needs: [02c_cr_create_population_af_match_positivecovidtest]
    outputs:
      moderately_sensitive:
        log: output/oac_match_log/05c_an_models_positivecovidtest.log
        table: "output/oac_match_tabfig/table2_positivecovidtest.txt"
      highly_sensitive:
        data1: "output/oac_match_tempdata/positivecovidtest_univar.ster"
        data2: "output/oac_match_tempdata/positivecovidtest_multivar1.ster"
        data3: "output/oac_match_tempdata/positivecovidtest_multivar2.ster"
        data4: "output/oac_match_tempdata/positivecovidtest_multivar3.ster"

  06c_an_models_ethnicity_af_match_positivecovidtest:
    run: stata-mp:latest analysis/06c_an_models_ethnicity.do positivecovidtest af_match
    needs: [02c_cr_create_population_af_match_positivecovidtest]
    outputs:
      moderately_sensitive:
        log: output/oac_match_log/06c_an_models_ethnicity_positivecovidtest.log
        table: "output/oac_match_tabfig/table3_positivecovidtest.txt"
      highly_sensitive:
        data1: "output/oac_match_tempdata/positivecovidtest_univar_ethn.ster"
        data2: "output/oac_match_tempdata/positivecovidtest_multivar1_ethn.ster"
        data3: "output/oac_match_tempdata/positivecovidtest_multivar2_ethn.ster"
        data4: "output/oac_match_tempdata/positivecovidtest_multivar2_withoutethn.ster"
        data5: "output/oac_match_tempdata/positivecovidtest_multivar3_ethn.ster"
        data6: "output/oac_match_tempdata/positivecovidtest_multivar3_withoutethn.ster"

  08c_an_model_checks_af_match_positivecovidtest:
    run: stata-mp:latest analysis/08c_an_model_checks.do positivecovidtest af_match
    needs: [02c_cr_create_population_af_match_positivecovidtest]
    outputs:
      moderately_sensitive:
        log: output/oac_match_log/08c_an_model_checks_positivecovidtest.log
        fig1: "output/oac_match_tabfig/positivecovidtest_schoenplot1.svg"
        fig2: "output/oac_match_tabfig/positivecovidtest_schoenplot2.svg"
        fig3: "output/oac_match_tabfig/positivecovidtest_schoenplot3.svg"
        fig4: "output/oac_match_tabfig/positivecovidtest_schoenplot4.svg"
        table1: "output/oac_match_tabfig/table5_positivecovidtest.txt"
        fig5: "output/oac_match_tabfig/positivecovidtest_schoenplot1_completecase.svg"
        fig6: "output/oac_match_tabfig/positivecovidtest_schoenplot2_completecase.svg"
        fig7: "output/oac_match_tabfig/positivecovidtest_schoenplot3_completecase_ethn.svg"
        fig8: "output/oac_match_tabfig/positivecovidtest_schoenplot3_completecase.svg"
        fig9: "output/oac_match_tabfig/positivecovidtest_schoenplot4_completecase_ethn.svg"
        fig10: "output/oac_match_tabfig/positivecovidtest_schoenplot4_completecase.svg"
        table2: "output/oac_match_tabfig/table6_positivecovidtest.txt"

  09a_an_models_plot_af_match_positivecovidtest:
    run: stata-mp:latest analysis/09a_an_models_plot.do positivecovidtest af_match 4 1 0.1
    needs: [02c_cr_create_population_af_match_positivecovidtest]
    outputs:
      moderately_sensitive:
        log: output/oac_match_log/09a_an_models_plot_positivecovidtest.log
        fig1: "output/oac_match_tabfig/adj_curves_positivecovidtest.svg"
        fig2: "output/oac_match_tabfig/diff_curves_positivecovidtest.svg"

  # Sensitivity Analysis 1
  # Remove people with antiplatelets
  # Objective 1: compare AF treated people with AF non-treated people

  # Primary Outcomes: ONS COVID-19 death
  SA1_02a_cr_create_population_af_oac_onscoviddeath:
    run: stata-mp:latest analysis/SA1_02a_cr_create_population.do onscoviddeath SA1_af_oac
    needs: [02aii_cr_create_population_af_oac_onscoviddeath]
    outputs:
      moderately_sensitive:
        log: output/oac_log/sens_analysis_1/SA1_02a_cr_create_population_onscoviddeath.log
      highly_sensitive:
        data1: "output/oac_tempdata/sens_analysis_1/analysis_dataset_onscoviddeath.dta"
        data2: "output/oac_tempdata/sens_analysis_1/analysis_dataset_STSET_onscoviddeath.dta"

  SA1_05a_an_models_af_oac_onscoviddeath:
    run: stata-mp:latest analysis/05a_an_models.do onscoviddeath SA1_af_oac
    needs: [SA1_02a_cr_create_population_af_oac_onscoviddeath, 05a_an_models_af_oac_onscoviddeath]
    outputs:
      moderately_sensitive:
        log: output/oac_log/sens_analysis_1/05a_an_models_onscoviddeath.log
        table: "output/oac_tabfig/sens_analysis_1/table2_onscoviddeath.txt"
      highly_sensitive:
        data1: "output/oac_tempdata/sens_analysis_1/onscoviddeath_univar.ster"
        data2: "output/oac_tempdata/sens_analysis_1/onscoviddeath_multivar1.ster"
        data3: "output/oac_tempdata/sens_analysis_1/onscoviddeath_multivar2.ster"
        data4: "output/oac_tempdata/sens_analysis_1/onscoviddeath_multivar3.ster"

  SA1_06a_an_models_ethnicity_af_oac_onscoviddeath:
    run: stata-mp:latest analysis/06a_an_models_ethnicity.do onscoviddeath SA1_af_oac
    needs: [SA1_02a_cr_create_population_af_oac_onscoviddeath, 06a_an_models_ethnicity_af_oac_onscoviddeath]
    outputs:
      moderately_sensitive:
        log: output/oac_log/sens_analysis_1/06a_an_models_ethnicity_onscoviddeath.log
        table: "output/oac_tabfig/sens_analysis_1/table3_onscoviddeath.txt"
      highly_sensitive:
        data1: "output/oac_tempdata/sens_analysis_1/onscoviddeath_univar_ethn.ster"
        data2: "output/oac_tempdata/sens_analysis_1/onscoviddeath_multivar1_ethn.ster"
        data3: "output/oac_tempdata/sens_analysis_1/onscoviddeath_multivar2_ethn.ster"
        data4: "output/oac_tempdata/sens_analysis_1/onscoviddeath_multivar2_withoutethn.ster"
        data5: "output/oac_tempdata/sens_analysis_1/onscoviddeath_multivar3_ethn.ster"
        data6: "output/oac_tempdata/sens_analysis_1/onscoviddeath_multivar3_withoutethn.ster"

  # Primary Outcomes: COVID-19 hospital admission
  SA1_02a_cr_create_population_af_oac_admitcovid:
    run: stata-mp:latest analysis/SA1_02a_cr_create_population.do admitcovid SA1_af_oac
    needs: [02aii_cr_create_population_af_oac_admitcovid]
    outputs:
      moderately_sensitive:
        log: output/oac_log/sens_analysis_1/SA1_02a_cr_create_population_admitcovid.log
      highly_sensitive:
        data1: "output/oac_tempdata/sens_analysis_1/analysis_dataset_admitcovid.dta"
        data2: "output/oac_tempdata/sens_analysis_1/analysis_dataset_STSET_admitcovid.dta"

  SA1_05a_an_models_af_oac_admitcovid:
    run: stata-mp:latest analysis/05a_an_models.do admitcovid SA1_af_oac
    needs: [SA1_02a_cr_create_population_af_oac_admitcovid, 05a_an_models_af_oac_admitcovid]
    outputs:
      moderately_sensitive:
        log: output/oac_log/sens_analysis_1/05a_an_models_admitcovid.log
        table: "output/oac_tabfig/sens_analysis_1/table2_admitcovid.txt"
      highly_sensitive:
        data1: "output/oac_tempdata/sens_analysis_1/admitcovid_univar.ster"
        data2: "output/oac_tempdata/sens_analysis_1/admitcovid_multivar1.ster"
        data3: "output/oac_tempdata/sens_analysis_1/admitcovid_multivar2.ster"
        data4: "output/oac_tempdata/sens_analysis_1/admitcovid_multivar3.ster"

  SA1_06a_an_models_ethnicity_af_oac_admitcovid:
    run: stata-mp:latest analysis/06a_an_models_ethnicity.do admitcovid SA1_af_oac
    needs: [SA1_02a_cr_create_population_af_oac_admitcovid, 06a_an_models_ethnicity_af_oac_admitcovid]
    outputs:
      moderately_sensitive:
        log: output/oac_log/sens_analysis_1/06a_an_models_ethnicity_admitcovid.log
        table: "output/oac_tabfig/sens_analysis_1/table3_admitcovid.txt"
      highly_sensitive:
        data1: "output/oac_tempdata/sens_analysis_1/admitcovid_univar_ethn.ster"
        data2: "output/oac_tempdata/sens_analysis_1/admitcovid_multivar1_ethn.ster"
        data3: "output/oac_tempdata/sens_analysis_1/admitcovid_multivar2_ethn.ster"
        data4: "output/oac_tempdata/sens_analysis_1/admitcovid_multivar2_withoutethn.ster"
        data5: "output/oac_tempdata/sens_analysis_1/admitcovid_multivar3_ethn.ster"
        data6: "output/oac_tempdata/sens_analysis_1/admitcovid_multivar3_withoutethn.ster"

  # Exploratory Outcomes: COVID-19 test
  SA1_02a_cr_create_population_af_oac_covidtest:
    run: stata-mp:latest analysis/SA1_02a_cr_create_population.do covidtest SA1_af_oac
    needs: [02aii_cr_create_population_af_oac_covidtest]
    outputs:
      moderately_sensitive:
        log: output/oac_log/sens_analysis_1/SA1_02a_cr_create_population_covidtest.log
      highly_sensitive:
        data1: "output/oac_tempdata/sens_analysis_1/analysis_dataset_covidtest.dta"
        data2: "output/oac_tempdata/sens_analysis_1/analysis_dataset_STSET_covidtest.dta"

  SA1_05a_an_models_af_oac_covidtest:
    run: stata-mp:latest analysis/05a_an_models.do covidtest SA1_af_oac
    needs: [SA1_02a_cr_create_population_af_oac_covidtest, 05a_an_models_af_oac_covidtest]
    outputs:
      moderately_sensitive:
        log: output/oac_log/sens_analysis_1/05a_an_models_covidtest.log
        table: "output/oac_tabfig/sens_analysis_1/table2_covidtest.txt"
      highly_sensitive:
        data1: "output/oac_tempdata/sens_analysis_1/covidtest_univar.ster"
        data2: "output/oac_tempdata/sens_analysis_1/covidtest_multivar1.ster"
        data3: "output/oac_tempdata/sens_analysis_1/covidtest_multivar2.ster"
        data4: "output/oac_tempdata/sens_analysis_1/covidtest_multivar3.ster"

  SA1_06a_an_models_ethnicity_af_oac_covidtest:
    run: stata-mp:latest analysis/06a_an_models_ethnicity.do covidtest SA1_af_oac
    needs: [SA1_02a_cr_create_population_af_oac_covidtest, 06a_an_models_ethnicity_af_oac_covidtest]
    outputs:
      moderately_sensitive:
        log: output/oac_log/sens_analysis_1/06a_an_models_ethnicity_covidtest.log
        table: "output/oac_tabfig/sens_analysis_1/table3_covidtest.txt"
      highly_sensitive:
        data1: "output/oac_tempdata/sens_analysis_1/covidtest_univar_ethn.ster"
        data2: "output/oac_tempdata/sens_analysis_1/covidtest_multivar1_ethn.ster"
        data3: "output/oac_tempdata/sens_analysis_1/covidtest_multivar2_ethn.ster"
        data4: "output/oac_tempdata/sens_analysis_1/covidtest_multivar2_withoutethn.ster"
        data5: "output/oac_tempdata/sens_analysis_1/covidtest_multivar3_ethn.ster"
        data6: "output/oac_tempdata/sens_analysis_1/covidtest_multivar3_withoutethn.ster"

  # Exploratory Outcomes: Positive COVID test
  SA1_02a_cr_create_population_af_oac_positivecovidtest:
    run: stata-mp:latest analysis/SA1_02a_cr_create_population.do positivecovidtest SA1_af_oac
    needs: [02aii_cr_create_population_af_oac_positivecovidtest]
    outputs:
      moderately_sensitive:
        log: output/oac_log/sens_analysis_1/SA1_02a_cr_create_population_positivecovidtest.log
      highly_sensitive:
        data1: "output/oac_tempdata/sens_analysis_1/analysis_dataset_positivecovidtest.dta"
        data2: "output/oac_tempdata/sens_analysis_1/analysis_dataset_STSET_positivecovidtest.dta"

  SA1_05a_an_models_af_oac_positivecovidtest:
    run: stata-mp:latest analysis/05a_an_models.do positivecovidtest SA1_af_oac
    needs: [SA1_02a_cr_create_population_af_oac_positivecovidtest, 05a_an_models_af_oac_positivecovidtest]
    outputs:
      moderately_sensitive:
        log: output/oac_log/sens_analysis_1/05a_an_models_positivecovidtest.log
        table: "output/oac_tabfig/sens_analysis_1/table2_positivecovidtest.txt"
      highly_sensitive:
        data1: "output/oac_tempdata/sens_analysis_1/positivecovidtest_univar.ster"
        data2: "output/oac_tempdata/sens_analysis_1/positivecovidtest_multivar1.ster"
        data3: "output/oac_tempdata/sens_analysis_1/positivecovidtest_multivar2.ster"
        data4: "output/oac_tempdata/sens_analysis_1/positivecovidtest_multivar3.ster"

  SA1_06a_an_models_ethnicity_af_oac_positivecovidtest:
    run: stata-mp:latest analysis/06a_an_models_ethnicity.do positivecovidtest SA1_af_oac
    needs: [SA1_02a_cr_create_population_af_oac_positivecovidtest, 06a_an_models_ethnicity_af_oac_positivecovidtest]
    outputs:
      moderately_sensitive:
        log: output/oac_log/sens_analysis_1/06a_an_models_ethnicity_positivecovidtest.log
        table: "output/oac_tabfig/sens_analysis_1/table3_positivecovidtest.txt"
      highly_sensitive:
        data1: "output/oac_tempdata/sens_analysis_1/positivecovidtest_univar_ethn.ster"
        data2: "output/oac_tempdata/sens_analysis_1/positivecovidtest_multivar1_ethn.ster"
        data3: "output/oac_tempdata/sens_analysis_1/positivecovidtest_multivar2_ethn.ster"
        data4: "output/oac_tempdata/sens_analysis_1/positivecovidtest_multivar2_withoutethn.ster"
        data5: "output/oac_tempdata/sens_analysis_1/positivecovidtest_multivar3_ethn.ster"
        data6: "output/oac_tempdata/sens_analysis_1/positivecovidtest_multivar3_withoutethn.ster"

  # Sensitivity Analysis 1
  # Remove people with antiplatelets
  # Objective 2: Compare warfarin users and DOAC users

  # Primary Outcomes: ONS COVID-19 death
  SA1_02b_cr_create_population_af_warfarin_onscoviddeath:
    run: stata-mp:latest analysis/SA1_02b_cr_create_population.do onscoviddeath SA1_af_warfarin
    needs: [02b_cr_create_population_af_warfarin_onscoviddeath]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/sens_analysis_1/SA1_02b_cr_create_population_onscoviddeath.log
      highly_sensitive:
        data1: "output/warfarin_tempdata/sens_analysis_1/analysis_dataset_onscoviddeath.dta"
        data2: "output/warfarin_tempdata/sens_analysis_1/analysis_dataset_STSET_onscoviddeath.dta"

  SA1_05b_an_models_af_warfarin_onscoviddeath:
    run: stata-mp:latest analysis/05b_an_models.do onscoviddeath SA1_af_warfarin
    needs: [SA1_02b_cr_create_population_af_warfarin_onscoviddeath, 05b_an_models_af_warfarin_onscoviddeath]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/sens_analysis_1/05b_an_models_onscoviddeath.log
        table: "output/warfarin_tabfig/sens_analysis_1/table2_onscoviddeath.txt"
      highly_sensitive:
        data1: "output/warfarin_tempdata/sens_analysis_1/onscoviddeath_univar.ster"
        data2: "output/warfarin_tempdata/sens_analysis_1/onscoviddeath_multivar1.ster"
        data3: "output/warfarin_tempdata/sens_analysis_1/onscoviddeath_multivar2.ster"
        data4: "output/warfarin_tempdata/sens_analysis_1/onscoviddeath_multivar3.ster"

  SA1_06b_an_models_ethnicity_af_warfarin_onscoviddeath:
    run: stata-mp:latest analysis/06b_an_models_ethnicity.do onscoviddeath SA1_af_warfarin
    needs: [SA1_02b_cr_create_population_af_warfarin_onscoviddeath, 06b_an_models_ethnicity_af_warfarin_onscoviddeath]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/sens_analysis_1/06b_an_models_ethnicity_onscoviddeath.log
        table: "output/warfarin_tabfig/sens_analysis_1/table3_onscoviddeath.txt"
      highly_sensitive:
        data1: "output/warfarin_tempdata/sens_analysis_1/onscoviddeath_univar_ethn.ster"
        data2: "output/warfarin_tempdata/sens_analysis_1/onscoviddeath_multivar1_ethn.ster"
        data3: "output/warfarin_tempdata/sens_analysis_1/onscoviddeath_multivar2_ethn.ster"
        data4: "output/warfarin_tempdata/sens_analysis_1/onscoviddeath_multivar2_withoutethn.ster"
        data5: "output/warfarin_tempdata/sens_analysis_1/onscoviddeath_multivar3_ethn.ster"
        data6: "output/warfarin_tempdata/sens_analysis_1/onscoviddeath_multivar3_withoutethn.ster"

  # Primary Outcomes: COVID-19 hospital admission
  SA1_02b_cr_create_population_af_warfarin_admitcovid:
    run: stata-mp:latest analysis/SA1_02b_cr_create_population.do admitcovid SA1_af_warfarin
    needs: [02b_cr_create_population_af_warfarin_admitcovid]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/sens_analysis_1/SA1_02b_cr_create_population_admitcovid.log
      highly_sensitive:
        data1: "output/warfarin_tempdata/sens_analysis_1/analysis_dataset_admitcovid.dta"
        data2: "output/warfarin_tempdata/sens_analysis_1/analysis_dataset_STSET_admitcovid.dta"

  SA1_05b_an_models_af_warfarin_admitcovid:
    run: stata-mp:latest analysis/05b_an_models.do admitcovid SA1_af_warfarin
    needs: [SA1_02b_cr_create_population_af_warfarin_admitcovid, 05b_an_models_af_warfarin_admitcovid]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/sens_analysis_1/05b_an_models_admitcovid.log
        table: "output/warfarin_tabfig/sens_analysis_1/table2_admitcovid.txt"
      highly_sensitive:
        data1: "output/warfarin_tempdata/sens_analysis_1/admitcovid_univar.ster"
        data2: "output/warfarin_tempdata/sens_analysis_1/admitcovid_multivar1.ster"
        data3: "output/warfarin_tempdata/sens_analysis_1/admitcovid_multivar2.ster"
        data4: "output/warfarin_tempdata/sens_analysis_1/admitcovid_multivar3.ster"

  SA1_06b_an_models_ethnicity_af_warfarin_admitcovid:
    run: stata-mp:latest analysis/06b_an_models_ethnicity.do admitcovid SA1_af_warfarin
    needs: [SA1_02b_cr_create_population_af_warfarin_admitcovid, 06b_an_models_ethnicity_af_warfarin_admitcovid]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/sens_analysis_1/06b_an_models_ethnicity_admitcovid.log
        table: "output/warfarin_tabfig/sens_analysis_1/table3_admitcovid.txt"
      highly_sensitive:
        data1: "output/warfarin_tempdata/sens_analysis_1/admitcovid_univar_ethn.ster"
        data2: "output/warfarin_tempdata/sens_analysis_1/admitcovid_multivar1_ethn.ster"
        data3: "output/warfarin_tempdata/sens_analysis_1/admitcovid_multivar2_ethn.ster"
        data4: "output/warfarin_tempdata/sens_analysis_1/admitcovid_multivar2_withoutethn.ster"
        data5: "output/warfarin_tempdata/sens_analysis_1/admitcovid_multivar3_ethn.ster"
        data6: "output/warfarin_tempdata/sens_analysis_1/admitcovid_multivar3_withoutethn.ster"

    # Exploratory Outcomes: Non-COVID death
  SA1_02b_cr_create_population_af_warfarin_onsnoncoviddeath:
    run: stata-mp:latest analysis/SA1_02b_cr_create_population.do onsnoncoviddeath SA1_af_warfarin
    needs: [02b_cr_create_population_af_warfarin_onsnoncoviddeath]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/sens_analysis_1/SA1_02b_cr_create_population_onsnoncoviddeath.log
      highly_sensitive:
        data1: "output/warfarin_tempdata/sens_analysis_1/analysis_dataset_onsnoncoviddeath.dta"
        data2: "output/warfarin_tempdata/sens_analysis_1/analysis_dataset_STSET_onsnoncoviddeath.dta"

  SA1_05b_an_models_af_warfarin_onsnoncoviddeath:
    run: stata-mp:latest analysis/05b_an_models.do onsnoncoviddeath SA1_af_warfarin
    needs: [SA1_02b_cr_create_population_af_warfarin_onsnoncoviddeath, 05b_an_models_af_warfarin_onsnoncoviddeath]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/sens_analysis_1/05b_an_models_onsnoncoviddeath.log
        table: "output/warfarin_tabfig/sens_analysis_1/table2_onsnoncoviddeath.txt"
      highly_sensitive:
        data1: "output/warfarin_tempdata/sens_analysis_1/onsnoncoviddeath_univar.ster"
        data2: "output/warfarin_tempdata/sens_analysis_1/onsnoncoviddeath_multivar1.ster"
        data3: "output/warfarin_tempdata/sens_analysis_1/onsnoncoviddeath_multivar2.ster"
        data4: "output/warfarin_tempdata/sens_analysis_1/onsnoncoviddeath_multivar3.ster"

  SA1_06b_an_models_ethnicity_af_warfarin_onsnoncoviddeath:
    run: stata-mp:latest analysis/06b_an_models_ethnicity.do onsnoncoviddeath SA1_af_warfarin
    needs: [SA1_02b_cr_create_population_af_warfarin_onsnoncoviddeath, 06b_an_models_ethnicity_af_warfarin_onsnoncoviddeath]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/sens_analysis_1/06b_an_models_ethnicity_onsnoncoviddeath.log
        table: "output/warfarin_tabfig/sens_analysis_1/table3_onsnoncoviddeath.txt"
      highly_sensitive:
        data1: "output/warfarin_tempdata/sens_analysis_1/onsnoncoviddeath_univar_ethn.ster"
        data2: "output/warfarin_tempdata/sens_analysis_1/onsnoncoviddeath_multivar1_ethn.ster"
        data3: "output/warfarin_tempdata/sens_analysis_1/onsnoncoviddeath_multivar2_ethn.ster"
        data4: "output/warfarin_tempdata/sens_analysis_1/onsnoncoviddeath_multivar2_withoutethn.ster"
        data5: "output/warfarin_tempdata/sens_analysis_1/onsnoncoviddeath_multivar3_ethn.ster"
        data6: "output/warfarin_tempdata/sens_analysis_1/onsnoncoviddeath_multivar3_withoutethn.ster"
        
  # Exploratory Outcomes: COVID-19 test
  SA1_02b_cr_create_population_af_warfarin_covidtest:
    run: stata-mp:latest analysis/SA1_02b_cr_create_population.do covidtest SA1_af_warfarin
    needs: [02b_cr_create_population_af_warfarin_covidtest]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/sens_analysis_1/SA1_02b_cr_create_population_covidtest.log
      highly_sensitive:
        data1: "output/warfarin_tempdata/sens_analysis_1/analysis_dataset_covidtest.dta"
        data2: "output/warfarin_tempdata/sens_analysis_1/analysis_dataset_STSET_covidtest.dta"

  SA1_05b_an_models_af_warfarin_covidtest:
    run: stata-mp:latest analysis/05b_an_models.do covidtest SA1_af_warfarin
    needs: [SA1_02b_cr_create_population_af_warfarin_covidtest, 05b_an_models_af_warfarin_covidtest]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/sens_analysis_1/05b_an_models_covidtest.log
        table: "output/warfarin_tabfig/sens_analysis_1/table2_covidtest.txt"
      highly_sensitive:
        data1: "output/warfarin_tempdata/sens_analysis_1/covidtest_univar.ster"
        data2: "output/warfarin_tempdata/sens_analysis_1/covidtest_multivar1.ster"
        data3: "output/warfarin_tempdata/sens_analysis_1/covidtest_multivar2.ster"
        data4: "output/warfarin_tempdata/sens_analysis_1/covidtest_multivar3.ster"

  SA1_06b_an_models_ethnicity_af_warfarin_covidtest:
    run: stata-mp:latest analysis/06b_an_models_ethnicity.do covidtest SA1_af_warfarin
    needs: [SA1_02b_cr_create_population_af_warfarin_covidtest, 06b_an_models_ethnicity_af_warfarin_covidtest]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/sens_analysis_1/06b_an_models_ethnicity_covidtest.log
        table: "output/warfarin_tabfig/sens_analysis_1/table3_covidtest.txt"
      highly_sensitive:
        data1: "output/warfarin_tempdata/sens_analysis_1/covidtest_univar_ethn.ster"
        data2: "output/warfarin_tempdata/sens_analysis_1/covidtest_multivar1_ethn.ster"
        data3: "output/warfarin_tempdata/sens_analysis_1/covidtest_multivar2_ethn.ster"
        data4: "output/warfarin_tempdata/sens_analysis_1/covidtest_multivar2_withoutethn.ster"
        data5: "output/warfarin_tempdata/sens_analysis_1/covidtest_multivar3_ethn.ster"
        data6: "output/warfarin_tempdata/sens_analysis_1/covidtest_multivar3_withoutethn.ster"

  # Exploratory Outcomes: Positive COVID test
  SA1_02b_cr_create_population_af_warfarin_positivecovidtest:
    run: stata-mp:latest analysis/SA1_02b_cr_create_population.do positivecovidtest SA1_af_warfarin
    needs: [02b_cr_create_population_af_warfarin_positivecovidtest]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/sens_analysis_1/SA1_02b_cr_create_population_positivecovidtest.log
      highly_sensitive:
        data1: "output/warfarin_tempdata/sens_analysis_1/analysis_dataset_positivecovidtest.dta"
        data2: "output/warfarin_tempdata/sens_analysis_1/analysis_dataset_STSET_positivecovidtest.dta"

  SA1_05b_an_models_af_warfarin_positivecovidtest:
    run: stata-mp:latest analysis/05b_an_models.do positivecovidtest SA1_af_warfarin
    needs: [SA1_02b_cr_create_population_af_warfarin_positivecovidtest, 05b_an_models_af_warfarin_positivecovidtest]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/sens_analysis_1/05b_an_models_positivecovidtest.log
        table: "output/warfarin_tabfig/sens_analysis_1/table2_positivecovidtest.txt"
      highly_sensitive:
        data1: "output/warfarin_tempdata/sens_analysis_1/positivecovidtest_univar.ster"
        data2: "output/warfarin_tempdata/sens_analysis_1/positivecovidtest_multivar1.ster"
        data3: "output/warfarin_tempdata/sens_analysis_1/positivecovidtest_multivar2.ster"
        data4: "output/warfarin_tempdata/sens_analysis_1/positivecovidtest_multivar3.ster"

  SA1_06b_an_models_ethnicity_af_warfarin_positivecovidtest:
    run: stata-mp:latest analysis/06b_an_models_ethnicity.do positivecovidtest SA1_af_warfarin
    needs: [SA1_02b_cr_create_population_af_warfarin_positivecovidtest, 06b_an_models_ethnicity_af_warfarin_positivecovidtest]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/sens_analysis_1/06b_an_models_ethnicity_positivecovidtest.log
        table: "output/warfarin_tabfig/sens_analysis_1/table3_positivecovidtest.txt"
      highly_sensitive:
        data1: "output/warfarin_tempdata/sens_analysis_1/positivecovidtest_univar_ethn.ster"
        data2: "output/warfarin_tempdata/sens_analysis_1/positivecovidtest_multivar1_ethn.ster"
        data3: "output/warfarin_tempdata/sens_analysis_1/positivecovidtest_multivar2_ethn.ster"
        data4: "output/warfarin_tempdata/sens_analysis_1/positivecovidtest_multivar2_withoutethn.ster"
        data5: "output/warfarin_tempdata/sens_analysis_1/positivecovidtest_multivar3_ethn.ster"
        data6: "output/warfarin_tempdata/sens_analysis_1/positivecovidtest_multivar3_withoutethn.ster"

# Sensitivity Analysis 1
# Remove people with antiplatelets
# Objective 1: compare AF treated people with general population

  # Primary Outcomes: ONS COVID-19 death
  SA1_02c_cr_create_population_af_match_onscoviddeath:
    run: stata-mp:latest analysis/SA1_02c_cr_create_population.do onscoviddeath SA1_af_match matched_cases_af_gen_pop
    needs: [02c_cr_create_population_af_match_onscoviddeath]
    outputs:
      moderately_sensitive:
        log: output/oac_match_log/sens_analysis_1/SA1_02c_cr_create_population_onscoviddeath.log
      highly_sensitive:
        data2: "output/oac_match_tempdata/sens_analysis_1/analysis_dataset_onscoviddeath.dta"
        data3: "output/oac_match_tempdata/sens_analysis_1/analysis_dataset_STSET_onscoviddeath.dta"

  SA1_05c_an_models_af_match_onscoviddeath:
    run: stata-mp:latest analysis/05c_an_models.do onscoviddeath SA1_af_match
    needs: [SA1_02c_cr_create_population_af_match_onscoviddeath, 05c_an_models_af_match_onscoviddeath]
    outputs:
      moderately_sensitive:
        log: output/oac_match_log/sens_analysis_1/05c_an_models_onscoviddeath.log
        table: "output/oac_match_tabfig/sens_analysis_1/table2_onscoviddeath.txt"
      highly_sensitive:
        data1: "output/oac_match_tempdata/sens_analysis_1/onscoviddeath_univar.ster"
        data2: "output/oac_match_tempdata/sens_analysis_1/onscoviddeath_multivar1.ster"
        data3: "output/oac_match_tempdata/sens_analysis_1/onscoviddeath_multivar2.ster"
        data4: "output/oac_match_tempdata/sens_analysis_1/onscoviddeath_multivar3.ster"

  SA1_06c_an_models_ethnicity_af_match_onscoviddeath:
    run: stata-mp:latest analysis/06c_an_models_ethnicity.do onscoviddeath SA1_af_match
    needs: [SA1_02c_cr_create_population_af_match_onscoviddeath, 06c_an_models_ethnicity_af_match_onscoviddeath]
    outputs:
      moderately_sensitive:
        log: output/oac_match_log/sens_analysis_1/06c_an_models_ethnicity_onscoviddeath.log
        table: "output/oac_match_tabfig/sens_analysis_1/table3_onscoviddeath.txt"
      highly_sensitive:
        data1: "output/oac_match_tempdata/sens_analysis_1/onscoviddeath_univar_ethn.ster"
        data2: "output/oac_match_tempdata/sens_analysis_1/onscoviddeath_multivar1_ethn.ster"
        data3: "output/oac_match_tempdata/sens_analysis_1/onscoviddeath_multivar2_ethn.ster"
        data4: "output/oac_match_tempdata/sens_analysis_1/onscoviddeath_multivar2_withoutethn.ster"
        data5: "output/oac_match_tempdata/sens_analysis_1/onscoviddeath_multivar3_ethn.ster"
        data6: "output/oac_match_tempdata/sens_analysis_1/onscoviddeath_multivar3_withoutethn.ster"

  # Primary Outcomes: COVID-19 hospital admission
  SA1_02c_cr_create_population_af_match_admitcovid:
    run: stata-mp:latest analysis/SA1_02c_cr_create_population.do admitcovid SA1_af_match matched_cases_af_gen_pop
    needs: [02c_cr_create_population_af_match_admitcovid]
    outputs:
      moderately_sensitive:
        log: output/oac_match_log/sens_analysis_1/SA1_02c_cr_create_population_admitcovid.log
      highly_sensitive:
        data2: "output/oac_match_tempdata/sens_analysis_1/analysis_dataset_admitcovid.dta"
        data3: "output/oac_match_tempdata/sens_analysis_1/analysis_dataset_STSET_admitcovid.dta"

  SA1_05c_an_models_af_match_admitcovid:
    run: stata-mp:latest analysis/05c_an_models.do admitcovid SA1_af_match
    needs: [SA1_02c_cr_create_population_af_match_admitcovid, 05c_an_models_af_match_admitcovid]
    outputs:
      moderately_sensitive:
        log: output/oac_match_log/sens_analysis_1/05c_an_models_admitcovid.log
        table: "output/oac_match_tabfig/sens_analysis_1/table2_admitcovid.txt"
      highly_sensitive:
        data1: "output/oac_match_tempdata/sens_analysis_1/admitcovid_univar.ster"
        data2: "output/oac_match_tempdata/sens_analysis_1/admitcovid_multivar1.ster"
        data3: "output/oac_match_tempdata/sens_analysis_1/admitcovid_multivar2.ster"
        data4: "output/oac_match_tempdata/sens_analysis_1/admitcovid_multivar3.ster"

  SA1_06c_an_models_ethnicity_af_match_admitcovid:
    run: stata-mp:latest analysis/06c_an_models_ethnicity.do admitcovid SA1_af_match
    needs: [SA1_02c_cr_create_population_af_match_admitcovid, 06c_an_models_ethnicity_af_match_admitcovid]
    outputs:
      moderately_sensitive:
        log: output/oac_match_log/sens_analysis_1/06c_an_models_ethnicity_admitcovid.log
        table: "output/oac_match_tabfig/sens_analysis_1/table3_admitcovid.txt"
      highly_sensitive:
        data1: "output/oac_match_tempdata/sens_analysis_1/admitcovid_univar_ethn.ster"
        data2: "output/oac_match_tempdata/sens_analysis_1/admitcovid_multivar1_ethn.ster"
        data3: "output/oac_match_tempdata/sens_analysis_1/admitcovid_multivar2_ethn.ster"
        data4: "output/oac_match_tempdata/sens_analysis_1/admitcovid_multivar2_withoutethn.ster"
        data5: "output/oac_match_tempdata/sens_analysis_1/admitcovid_multivar3_ethn.ster"
        data6: "output/oac_match_tempdata/sens_analysis_1/admitcovid_multivar3_withoutethn.ster"

  # Exploratory Outcomes: COVID-19 test
  SA1_02c_cr_create_population_af_match_covidtest:
    run: stata-mp:latest analysis/SA1_02c_cr_create_population.do covidtest SA1_af_match matched_cases_af_gen_pop
    needs: [02c_cr_create_population_af_match_covidtest]
    outputs:
      moderately_sensitive:
        log: output/oac_match_log/sens_analysis_1/SA1_02c_cr_create_population_covidtest.log
      highly_sensitive:
        data2: "output/oac_match_tempdata/sens_analysis_1/analysis_dataset_covidtest.dta"
        data3: "output/oac_match_tempdata/sens_analysis_1/analysis_dataset_STSET_covidtest.dta"

  SA1_05c_an_models_af_match_covidtest:
    run: stata-mp:latest analysis/05c_an_models.do covidtest SA1_af_match
    needs: [SA1_02c_cr_create_population_af_match_covidtest, 05c_an_models_af_match_covidtest]
    outputs:
      moderately_sensitive:
        log: output/oac_match_log/sens_analysis_1/05c_an_models_covidtest.log
        table: "output/oac_match_tabfig/sens_analysis_1/table2_covidtest.txt"
      highly_sensitive:
        data1: "output/oac_match_tempdata/sens_analysis_1/covidtest_univar.ster"
        data2: "output/oac_match_tempdata/sens_analysis_1/covidtest_multivar1.ster"
        data3: "output/oac_match_tempdata/sens_analysis_1/covidtest_multivar2.ster"
        data4: "output/oac_match_tempdata/sens_analysis_1/covidtest_multivar3.ster"

  SA1_06c_an_models_ethnicity_af_match_covidtest:
    run: stata-mp:latest analysis/06c_an_models_ethnicity.do covidtest SA1_af_match
    needs: [SA1_02c_cr_create_population_af_match_covidtest, 06c_an_models_ethnicity_af_match_covidtest]
    outputs:
      moderately_sensitive:
        log: output/oac_match_log/sens_analysis_1/06c_an_models_ethnicity_covidtest.log
        table: "output/oac_match_tabfig/sens_analysis_1/table3_covidtest.txt"
      highly_sensitive:
        data1: "output/oac_match_tempdata/sens_analysis_1/covidtest_univar_ethn.ster"
        data2: "output/oac_match_tempdata/sens_analysis_1/covidtest_multivar1_ethn.ster"
        data3: "output/oac_match_tempdata/sens_analysis_1/covidtest_multivar2_ethn.ster"
        data4: "output/oac_match_tempdata/sens_analysis_1/covidtest_multivar2_withoutethn.ster"
        data5: "output/oac_match_tempdata/sens_analysis_1/covidtest_multivar3_ethn.ster"
        data6: "output/oac_match_tempdata/sens_analysis_1/covidtest_multivar3_withoutethn.ster"

  # Exploratory Outcomes: Positive COVID test
  SA1_02c_cr_create_population_af_match_positivecovidtest:
    run: stata-mp:latest analysis/SA1_02c_cr_create_population.do positivecovidtest SA1_af_match matched_cases_af_gen_pop
    needs: [02c_cr_create_population_af_match_positivecovidtest]
    outputs:
      moderately_sensitive:
        log: output/oac_match_log/sens_analysis_1/SA1_02c_cr_create_population_positivecovidtest.log
      highly_sensitive:
        data2: "output/oac_match_tempdata/sens_analysis_1/analysis_dataset_positivecovidtest.dta"
        data3: "output/oac_match_tempdata/sens_analysis_1/analysis_dataset_STSET_positivecovidtest.dta"

  SA1_05c_an_models_af_match_positivecovidtest:
    run: stata-mp:latest analysis/05c_an_models.do positivecovidtest SA1_af_match
    needs: [SA1_02c_cr_create_population_af_match_positivecovidtest, 05c_an_models_af_match_positivecovidtest]
    outputs:
      moderately_sensitive:
        log: output/oac_match_log/sens_analysis_1/05c_an_models_positivecovidtest.log
        table: "output/oac_match_tabfig/sens_analysis_1/table2_positivecovidtest.txt"
      highly_sensitive:
        data1: "output/oac_match_tempdata/sens_analysis_1/positivecovidtest_univar.ster"
        data2: "output/oac_match_tempdata/sens_analysis_1/positivecovidtest_multivar1.ster"
        data3: "output/oac_match_tempdata/sens_analysis_1/positivecovidtest_multivar2.ster"
        data4: "output/oac_match_tempdata/sens_analysis_1/positivecovidtest_multivar3.ster"

  SA1_06c_an_models_ethnicity_af_match_positivecovidtest:
    run: stata-mp:latest analysis/06c_an_models_ethnicity.do positivecovidtest SA1_af_match
    needs: [SA1_02c_cr_create_population_af_match_positivecovidtest, 06c_an_models_ethnicity_af_match_positivecovidtest]
    outputs:
      moderately_sensitive:
        log: output/oac_match_log/sens_analysis_1/06c_an_models_ethnicity_positivecovidtest.log
        table: "output/oac_match_tabfig/sens_analysis_1/table3_positivecovidtest.txt"
      highly_sensitive:
        data1: "output/oac_match_tempdata/sens_analysis_1/positivecovidtest_univar_ethn.ster"
        data2: "output/oac_match_tempdata/sens_analysis_1/positivecovidtest_multivar1_ethn.ster"
        data3: "output/oac_match_tempdata/sens_analysis_1/positivecovidtest_multivar2_ethn.ster"
        data4: "output/oac_match_tempdata/sens_analysis_1/positivecovidtest_multivar2_withoutethn.ster"
        data5: "output/oac_match_tempdata/sens_analysis_1/positivecovidtest_multivar3_ethn.ster"
        data6: "output/oac_match_tempdata/sens_analysis_1/positivecovidtest_multivar3_withoutethn.ster"

 # Sensitivity Analysis 2
  # limit the study cohort to people who aged 55 
  # Objective 1: compare AF treated people with AF non-treated people

  # Primary Outcomes: ONS COVID-19 death
  SA2_02a_cr_create_population_af_oac_onscoviddeath:
    run: stata-mp:latest analysis/SA2_02a_cr_create_population.do onscoviddeath SA2_af_oac
    needs: [02aii_cr_create_population_af_oac_onscoviddeath]
    outputs:
      moderately_sensitive:
        log: output/oac_log/sens_analysis_2/SA2_02a_cr_create_population_onscoviddeath.log
      highly_sensitive:
        data1: "output/oac_tempdata/sens_analysis_2/analysis_dataset_onscoviddeath.dta"
        data2: "output/oac_tempdata/sens_analysis_2/analysis_dataset_STSET_onscoviddeath.dta"

  SA2_05a_an_models_af_oac_onscoviddeath:
    run: stata-mp:latest analysis/05a_an_models.do onscoviddeath SA2_af_oac
    needs: [SA2_02a_cr_create_population_af_oac_onscoviddeath, 05a_an_models_af_oac_onscoviddeath]
    outputs:
      moderately_sensitive:
        log: output/oac_log/sens_analysis_2/05a_an_models_onscoviddeath.log
        table: "output/oac_tabfig/sens_analysis_2/table2_onscoviddeath.txt"
      highly_sensitive:
        data1: "output/oac_tempdata/sens_analysis_2/onscoviddeath_univar.ster"
        data2: "output/oac_tempdata/sens_analysis_2/onscoviddeath_multivar1.ster"
        data3: "output/oac_tempdata/sens_analysis_2/onscoviddeath_multivar2.ster"
        data4: "output/oac_tempdata/sens_analysis_2/onscoviddeath_multivar3.ster"

  SA2_06a_an_models_ethnicity_af_oac_onscoviddeath:
    run: stata-mp:latest analysis/06a_an_models_ethnicity.do onscoviddeath SA2_af_oac
    needs: [SA2_02a_cr_create_population_af_oac_onscoviddeath, 06a_an_models_ethnicity_af_oac_onscoviddeath]
    outputs:
      moderately_sensitive:
        log: output/oac_log/sens_analysis_2/06a_an_models_ethnicity_onscoviddeath.log
        table: "output/oac_tabfig/sens_analysis_2/table3_onscoviddeath.txt"
      highly_sensitive:
        data1: "output/oac_tempdata/sens_analysis_2/onscoviddeath_univar_ethn.ster"
        data2: "output/oac_tempdata/sens_analysis_2/onscoviddeath_multivar1_ethn.ster"
        data3: "output/oac_tempdata/sens_analysis_2/onscoviddeath_multivar2_ethn.ster"
        data4: "output/oac_tempdata/sens_analysis_2/onscoviddeath_multivar2_withoutethn.ster"
        data5: "output/oac_tempdata/sens_analysis_2/onscoviddeath_multivar3_ethn.ster"
        data6: "output/oac_tempdata/sens_analysis_2/onscoviddeath_multivar3_withoutethn.ster"

  # Primary Outcomes: COVID-19 hospital admission
  SA2_02a_cr_create_population_af_oac_admitcovid:
    run: stata-mp:latest analysis/SA2_02a_cr_create_population.do admitcovid SA2_af_oac
    needs: [02aii_cr_create_population_af_oac_admitcovid]
    outputs:
      moderately_sensitive:
        log: output/oac_log/sens_analysis_2/SA2_02a_cr_create_population_admitcovid.log
      highly_sensitive:
        data1: "output/oac_tempdata/sens_analysis_2/analysis_dataset_admitcovid.dta"
        data2: "output/oac_tempdata/sens_analysis_2/analysis_dataset_STSET_admitcovid.dta"

  SA2_05a_an_models_af_oac_admitcovid:
    run: stata-mp:latest analysis/05a_an_models.do admitcovid SA2_af_oac
    needs: [SA2_02a_cr_create_population_af_oac_admitcovid, 05a_an_models_af_oac_admitcovid]
    outputs:
      moderately_sensitive:
        log: output/oac_log/sens_analysis_2/05a_an_models_admitcovid.log
        table: "output/oac_tabfig/sens_analysis_2/table2_admitcovid.txt"
      highly_sensitive:
        data1: "output/oac_tempdata/sens_analysis_2/admitcovid_univar.ster"
        data2: "output/oac_tempdata/sens_analysis_2/admitcovid_multivar1.ster"
        data3: "output/oac_tempdata/sens_analysis_2/admitcovid_multivar2.ster"
        data4: "output/oac_tempdata/sens_analysis_2/admitcovid_multivar3.ster"

  SA2_06a_an_models_ethnicity_af_oac_admitcovid:
    run: stata-mp:latest analysis/06a_an_models_ethnicity.do admitcovid SA2_af_oac
    needs: [SA2_02a_cr_create_population_af_oac_admitcovid, 06a_an_models_ethnicity_af_oac_admitcovid]
    outputs:
      moderately_sensitive:
        log: output/oac_log/sens_analysis_2/06a_an_models_ethnicity_admitcovid.log
        table: "output/oac_tabfig/sens_analysis_2/table3_admitcovid.txt"
      highly_sensitive:
        data1: "output/oac_tempdata/sens_analysis_2/admitcovid_univar_ethn.ster"
        data2: "output/oac_tempdata/sens_analysis_2/admitcovid_multivar1_ethn.ster"
        data3: "output/oac_tempdata/sens_analysis_2/admitcovid_multivar2_ethn.ster"
        data4: "output/oac_tempdata/sens_analysis_2/admitcovid_multivar2_withoutethn.ster"
        data5: "output/oac_tempdata/sens_analysis_2/admitcovid_multivar3_ethn.ster"
        data6: "output/oac_tempdata/sens_analysis_2/admitcovid_multivar3_withoutethn.ster"

  # Exploratory Outcomes: COVID-19 test
  SA2_02a_cr_create_population_af_oac_covidtest:
    run: stata-mp:latest analysis/SA2_02a_cr_create_population.do covidtest SA2_af_oac
    needs: [02aii_cr_create_population_af_oac_covidtest]
    outputs:
      moderately_sensitive:
        log: output/oac_log/sens_analysis_2/SA2_02a_cr_create_population_covidtest.log
      highly_sensitive:
        data1: "output/oac_tempdata/sens_analysis_2/analysis_dataset_covidtest.dta"
        data2: "output/oac_tempdata/sens_analysis_2/analysis_dataset_STSET_covidtest.dta"

  SA2_05a_an_models_af_oac_covidtest:
    run: stata-mp:latest analysis/05a_an_models.do covidtest SA2_af_oac
    needs: [SA2_02a_cr_create_population_af_oac_covidtest, 05a_an_models_af_oac_covidtest]
    outputs:
      moderately_sensitive:
        log: output/oac_log/sens_analysis_2/05a_an_models_covidtest.log
        table: "output/oac_tabfig/sens_analysis_2/table2_covidtest.txt"
      highly_sensitive:
        data1: "output/oac_tempdata/sens_analysis_2/covidtest_univar.ster"
        data2: "output/oac_tempdata/sens_analysis_2/covidtest_multivar1.ster"
        data3: "output/oac_tempdata/sens_analysis_2/covidtest_multivar2.ster"
        data4: "output/oac_tempdata/sens_analysis_2/covidtest_multivar3.ster"

  SA2_06a_an_models_ethnicity_af_oac_covidtest:
    run: stata-mp:latest analysis/06a_an_models_ethnicity.do covidtest SA2_af_oac
    needs: [SA2_02a_cr_create_population_af_oac_covidtest, 06a_an_models_ethnicity_af_oac_covidtest]
    outputs:
      moderately_sensitive:
        log: output/oac_log/sens_analysis_2/06a_an_models_ethnicity_covidtest.log
        table: "output/oac_tabfig/sens_analysis_2/table3_covidtest.txt"
      highly_sensitive:
        data1: "output/oac_tempdata/sens_analysis_2/covidtest_univar_ethn.ster"
        data2: "output/oac_tempdata/sens_analysis_2/covidtest_multivar1_ethn.ster"
        data3: "output/oac_tempdata/sens_analysis_2/covidtest_multivar2_ethn.ster"
        data4: "output/oac_tempdata/sens_analysis_2/covidtest_multivar2_withoutethn.ster"
        data5: "output/oac_tempdata/sens_analysis_2/covidtest_multivar3_ethn.ster"
        data6: "output/oac_tempdata/sens_analysis_2/covidtest_multivar3_withoutethn.ster"

  # Exploratory Outcomes: Positive COVID test
  SA2_02a_cr_create_population_af_oac_positivecovidtest:
    run: stata-mp:latest analysis/SA2_02a_cr_create_population.do positivecovidtest SA2_af_oac
    needs: [02aii_cr_create_population_af_oac_positivecovidtest]
    outputs:
      moderately_sensitive:
        log: output/oac_log/sens_analysis_2/SA2_02a_cr_create_population_positivecovidtest.log
      highly_sensitive:
        data1: "output/oac_tempdata/sens_analysis_2/analysis_dataset_positivecovidtest.dta"
        data2: "output/oac_tempdata/sens_analysis_2/analysis_dataset_STSET_positivecovidtest.dta"

  SA2_05a_an_models_af_oac_positivecovidtest:
    run: stata-mp:latest analysis/05a_an_models.do positivecovidtest SA2_af_oac
    needs: [SA2_02a_cr_create_population_af_oac_positivecovidtest, 05a_an_models_af_oac_positivecovidtest]
    outputs:
      moderately_sensitive:
        log: output/oac_log/sens_analysis_2/05a_an_models_positivecovidtest.log
        table: "output/oac_tabfig/sens_analysis_2/table2_positivecovidtest.txt"
      highly_sensitive:
        data1: "output/oac_tempdata/sens_analysis_2/positivecovidtest_univar.ster"
        data2: "output/oac_tempdata/sens_analysis_2/positivecovidtest_multivar1.ster"
        data3: "output/oac_tempdata/sens_analysis_2/positivecovidtest_multivar2.ster"
        data4: "output/oac_tempdata/sens_analysis_2/positivecovidtest_multivar3.ster"

  SA2_06a_an_models_ethnicity_af_oac_positivecovidtest:
    run: stata-mp:latest analysis/06a_an_models_ethnicity.do positivecovidtest SA2_af_oac
    needs: [SA2_02a_cr_create_population_af_oac_positivecovidtest, 06a_an_models_ethnicity_af_oac_positivecovidtest]
    outputs:
      moderately_sensitive:
        log: output/oac_log/sens_analysis_2/06a_an_models_ethnicity_positivecovidtest.log
        table: "output/oac_tabfig/sens_analysis_2/table3_positivecovidtest.txt"
      highly_sensitive:
        data1: "output/oac_tempdata/sens_analysis_2/positivecovidtest_univar_ethn.ster"
        data2: "output/oac_tempdata/sens_analysis_2/positivecovidtest_multivar1_ethn.ster"
        data3: "output/oac_tempdata/sens_analysis_2/positivecovidtest_multivar2_ethn.ster"
        data4: "output/oac_tempdata/sens_analysis_2/positivecovidtest_multivar2_withoutethn.ster"
        data5: "output/oac_tempdata/sens_analysis_2/positivecovidtest_multivar3_ethn.ster"
        data6: "output/oac_tempdata/sens_analysis_2/positivecovidtest_multivar3_withoutethn.ster"

# Sensitivity Analysis 2
# limit the study cohort to people who aged 55 
# Objective 1: compare AF treated people with general population

  # Primary Outcomes: ONS COVID-19 death
  SA2_02c_cr_create_population_af_match_onscoviddeath:
    run: stata-mp:latest analysis/SA2_02c_cr_create_population.do onscoviddeath SA2_af_match matched_cases_af_gen_pop
    needs: [02c_cr_create_population_af_match_onscoviddeath]
    outputs:
      moderately_sensitive:
        log: output/oac_match_log/sens_analysis_2/SA2_02c_cr_create_population_onscoviddeath.log
      highly_sensitive:
        data2: "output/oac_match_tempdata/sens_analysis_2/analysis_dataset_onscoviddeath.dta"
        data3: "output/oac_match_tempdata/sens_analysis_2/analysis_dataset_STSET_onscoviddeath.dta"

  SA2_05c_an_models_af_match_onscoviddeath:
    run: stata-mp:latest analysis/05c_an_models.do onscoviddeath SA2_af_match
    needs: [SA2_02c_cr_create_population_af_match_onscoviddeath, 05c_an_models_af_match_onscoviddeath]
    outputs:
      moderately_sensitive:
        log: output/oac_match_log/sens_analysis_2/05c_an_models_onscoviddeath.log
        table: "output/oac_match_tabfig/sens_analysis_2/table2_onscoviddeath.txt"
      highly_sensitive:
        data1: "output/oac_match_tempdata/sens_analysis_2/onscoviddeath_univar.ster"
        data2: "output/oac_match_tempdata/sens_analysis_2/onscoviddeath_multivar1.ster"
        data3: "output/oac_match_tempdata/sens_analysis_2/onscoviddeath_multivar2.ster"
        data4: "output/oac_match_tempdata/sens_analysis_2/onscoviddeath_multivar3.ster"

  SA2_06c_an_models_ethnicity_af_match_onscoviddeath:
    run: stata-mp:latest analysis/06c_an_models_ethnicity.do onscoviddeath SA2_af_match
    needs: [SA2_02c_cr_create_population_af_match_onscoviddeath, 06c_an_models_ethnicity_af_match_onscoviddeath]
    outputs:
      moderately_sensitive:
        log: output/oac_match_log/sens_analysis_2/06c_an_models_ethnicity_onscoviddeath.log
        table: "output/oac_match_tabfig/sens_analysis_2/table3_onscoviddeath.txt"
      highly_sensitive:
        data1: "output/oac_match_tempdata/sens_analysis_2/onscoviddeath_univar_ethn.ster"
        data2: "output/oac_match_tempdata/sens_analysis_2/onscoviddeath_multivar1_ethn.ster"
        data3: "output/oac_match_tempdata/sens_analysis_2/onscoviddeath_multivar2_ethn.ster"
        data4: "output/oac_match_tempdata/sens_analysis_2/onscoviddeath_multivar2_withoutethn.ster"
        data5: "output/oac_match_tempdata/sens_analysis_2/onscoviddeath_multivar3_ethn.ster"
        data6: "output/oac_match_tempdata/sens_analysis_2/onscoviddeath_multivar3_withoutethn.ster"

  # Primary Outcomes: COVID-19 hospital admission
  SA2_02c_cr_create_population_af_match_admitcovid:
    run: stata-mp:latest analysis/SA2_02c_cr_create_population.do admitcovid SA2_af_match 
    needs: [02c_cr_create_population_af_match_admitcovid]
    outputs:
      moderately_sensitive:
        log: output/oac_match_log/sens_analysis_2/SA2_02c_cr_create_population_admitcovid.log
      highly_sensitive:
        data2: "output/oac_match_tempdata/sens_analysis_2/analysis_dataset_admitcovid.dta"
        data3: "output/oac_match_tempdata/sens_analysis_2/analysis_dataset_STSET_admitcovid.dta"

  SA2_05c_an_models_af_match_admitcovid:
    run: stata-mp:latest analysis/05c_an_models.do admitcovid SA2_af_match
    needs: [SA2_02c_cr_create_population_af_match_admitcovid, 05c_an_models_af_match_admitcovid]
    outputs:
      moderately_sensitive:
        log: output/oac_match_log/sens_analysis_2/05c_an_models_admitcovid.log
        table: "output/oac_match_tabfig/sens_analysis_2/table2_admitcovid.txt"
      highly_sensitive:
        data1: "output/oac_match_tempdata/sens_analysis_2/admitcovid_univar.ster"
        data2: "output/oac_match_tempdata/sens_analysis_2/admitcovid_multivar1.ster"
        data3: "output/oac_match_tempdata/sens_analysis_2/admitcovid_multivar2.ster"
        data4: "output/oac_match_tempdata/sens_analysis_2/admitcovid_multivar3.ster"

  SA2_06c_an_models_ethnicity_af_match_admitcovid:
    run: stata-mp:latest analysis/06c_an_models_ethnicity.do admitcovid SA2_af_match
    needs: [SA2_02c_cr_create_population_af_match_admitcovid, 06c_an_models_ethnicity_af_match_admitcovid]
    outputs:
      moderately_sensitive:
        log: output/oac_match_log/sens_analysis_2/06c_an_models_ethnicity_admitcovid.log
        table: "output/oac_match_tabfig/sens_analysis_2/table3_admitcovid.txt"
      highly_sensitive:
        data1: "output/oac_match_tempdata/sens_analysis_2/admitcovid_univar_ethn.ster"
        data2: "output/oac_match_tempdata/sens_analysis_2/admitcovid_multivar1_ethn.ster"
        data3: "output/oac_match_tempdata/sens_analysis_2/admitcovid_multivar2_ethn.ster"
        data4: "output/oac_match_tempdata/sens_analysis_2/admitcovid_multivar2_withoutethn.ster"
        data5: "output/oac_match_tempdata/sens_analysis_2/admitcovid_multivar3_ethn.ster"
        data6: "output/oac_match_tempdata/sens_analysis_2/admitcovid_multivar3_withoutethn.ster"

  # Exploratory Outcomes: COVID-19 test
  SA2_02c_cr_create_population_af_match_covidtest:
    run: stata-mp:latest analysis/SA2_02c_cr_create_population.do covidtest SA2_af_match
    needs: [02c_cr_create_population_af_match_covidtest]
    outputs:
      moderately_sensitive:
        log: output/oac_match_log/sens_analysis_2/SA2_02c_cr_create_population_covidtest.log
      highly_sensitive:
        data2: "output/oac_match_tempdata/sens_analysis_2/analysis_dataset_covidtest.dta"
        data3: "output/oac_match_tempdata/sens_analysis_2/analysis_dataset_STSET_covidtest.dta"

  SA2_05c_an_models_af_match_covidtest:
    run: stata-mp:latest analysis/05c_an_models.do covidtest SA2_af_match
    needs: [SA2_02c_cr_create_population_af_match_covidtest, 05c_an_models_af_match_covidtest]
    outputs:
      moderately_sensitive:
        log: output/oac_match_log/sens_analysis_2/05c_an_models_covidtest.log
        table: "output/oac_match_tabfig/sens_analysis_2/table2_covidtest.txt"
      highly_sensitive:
        data1: "output/oac_match_tempdata/sens_analysis_2/covidtest_univar.ster"
        data2: "output/oac_match_tempdata/sens_analysis_2/covidtest_multivar1.ster"
        data3: "output/oac_match_tempdata/sens_analysis_2/covidtest_multivar2.ster"
        data4: "output/oac_match_tempdata/sens_analysis_2/covidtest_multivar3.ster"

  SA2_06c_an_models_ethnicity_af_match_covidtest:
    run: stata-mp:latest analysis/06c_an_models_ethnicity.do covidtest SA2_af_match
    needs: [SA2_02c_cr_create_population_af_match_covidtest, 06c_an_models_ethnicity_af_match_covidtest]
    outputs:
      moderately_sensitive:
        log: output/oac_match_log/sens_analysis_2/06c_an_models_ethnicity_covidtest.log
        table: "output/oac_match_tabfig/sens_analysis_2/table3_covidtest.txt"
      highly_sensitive:
        data1: "output/oac_match_tempdata/sens_analysis_2/covidtest_univar_ethn.ster"
        data2: "output/oac_match_tempdata/sens_analysis_2/covidtest_multivar1_ethn.ster"
        data3: "output/oac_match_tempdata/sens_analysis_2/covidtest_multivar2_ethn.ster"
        data4: "output/oac_match_tempdata/sens_analysis_2/covidtest_multivar2_withoutethn.ster"
        data5: "output/oac_match_tempdata/sens_analysis_2/covidtest_multivar3_ethn.ster"
        data6: "output/oac_match_tempdata/sens_analysis_2/covidtest_multivar3_withoutethn.ster"

  # Exploratory Outcomes: Positive COVID test
  SA2_02c_cr_create_population_af_match_positivecovidtest:
    run: stata-mp:latest analysis/SA2_02c_cr_create_population.do positivecovidtest SA2_af_match
    needs: [02c_cr_create_population_af_match_positivecovidtest]
    outputs:
      moderately_sensitive:
        log: output/oac_match_log/sens_analysis_2/SA2_02c_cr_create_population_positivecovidtest.log
      highly_sensitive:
        data2: "output/oac_match_tempdata/sens_analysis_2/analysis_dataset_positivecovidtest.dta"
        data3: "output/oac_match_tempdata/sens_analysis_2/analysis_dataset_STSET_positivecovidtest.dta"

  SA2_05c_an_models_af_match_positivecovidtest:
    run: stata-mp:latest analysis/05c_an_models.do positivecovidtest SA2_af_match
    needs: [SA2_02c_cr_create_population_af_match_positivecovidtest, 05c_an_models_af_match_positivecovidtest]
    outputs:
      moderately_sensitive:
        log: output/oac_match_log/sens_analysis_2/05c_an_models_positivecovidtest.log
        table: "output/oac_match_tabfig/sens_analysis_2/table2_positivecovidtest.txt"
      highly_sensitive:
        data1: "output/oac_match_tempdata/sens_analysis_2/positivecovidtest_univar.ster"
        data2: "output/oac_match_tempdata/sens_analysis_2/positivecovidtest_multivar1.ster"
        data3: "output/oac_match_tempdata/sens_analysis_2/positivecovidtest_multivar2.ster"
        data4: "output/oac_match_tempdata/sens_analysis_2/positivecovidtest_multivar3.ster"

  SA2_06c_an_models_ethnicity_af_match_positivecovidtest:
    run: stata-mp:latest analysis/06c_an_models_ethnicity.do positivecovidtest SA2_af_match
    needs: [SA2_02c_cr_create_population_af_match_positivecovidtest, 06c_an_models_ethnicity_af_match_positivecovidtest]
    outputs:
      moderately_sensitive:
        log: output/oac_match_log/sens_analysis_2/06c_an_models_ethnicity_positivecovidtest.log
        table: "output/oac_match_tabfig/sens_analysis_2/table3_positivecovidtest.txt"
      highly_sensitive:
        data1: "output/oac_match_tempdata/sens_analysis_2/positivecovidtest_univar_ethn.ster"
        data2: "output/oac_match_tempdata/sens_analysis_2/positivecovidtest_multivar1_ethn.ster"
        data3: "output/oac_match_tempdata/sens_analysis_2/positivecovidtest_multivar2_ethn.ster"
        data4: "output/oac_match_tempdata/sens_analysis_2/positivecovidtest_multivar2_withoutethn.ster"
        data5: "output/oac_match_tempdata/sens_analysis_2/positivecovidtest_multivar3_ethn.ster"
        data6: "output/oac_match_tempdata/sens_analysis_2/positivecovidtest_multivar3_withoutethn.ster"

  # Sensitivity Analysis 3
  # Exclude people who were prescribed both warfarin and DOACs on the same day as the latest OAC prescription
  # Objective 2: Compare warfarin users and DOAC users

  # Primary Outcomes: ONS COVID-19 death
  SA3_02b_cr_create_population_af_warfarin_onscoviddeath:
    run: stata-mp:latest analysis/SA3_02b_cr_create_population.do onscoviddeath SA3_af_warfarin
    needs: [02b_cr_create_population_af_warfarin_onscoviddeath]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/sens_analysis_3/SA3_02b_cr_create_population_onscoviddeath.log
      highly_sensitive:
        data1: "output/warfarin_tempdata/sens_analysis_3/analysis_dataset_onscoviddeath.dta"
        data2: "output/warfarin_tempdata/sens_analysis_3/analysis_dataset_STSET_onscoviddeath.dta"

  SA3_05b_an_models_af_warfarin_onscoviddeath:
    run: stata-mp:latest analysis/05b_an_models.do onscoviddeath SA3_af_warfarin
    needs: [SA3_02b_cr_create_population_af_warfarin_onscoviddeath, 05b_an_models_af_warfarin_onscoviddeath]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/sens_analysis_3/05b_an_models_onscoviddeath.log
        table: "output/warfarin_tabfig/sens_analysis_3/table2_onscoviddeath.txt"
      highly_sensitive:
        data1: "output/warfarin_tempdata/sens_analysis_3/onscoviddeath_univar.ster"
        data2: "output/warfarin_tempdata/sens_analysis_3/onscoviddeath_multivar1.ster"
        data3: "output/warfarin_tempdata/sens_analysis_3/onscoviddeath_multivar2.ster"
        data4: "output/warfarin_tempdata/sens_analysis_3/onscoviddeath_multivar3.ster"

  SA3_06b_an_models_ethnicity_af_warfarin_onscoviddeath:
    run: stata-mp:latest analysis/06b_an_models_ethnicity.do onscoviddeath SA3_af_warfarin
    needs: [SA3_02b_cr_create_population_af_warfarin_onscoviddeath, 06b_an_models_ethnicity_af_warfarin_onscoviddeath]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/sens_analysis_3/06b_an_models_ethnicity_onscoviddeath.log
        table: "output/warfarin_tabfig/sens_analysis_3/table3_onscoviddeath.txt"
      highly_sensitive:
        data1: "output/warfarin_tempdata/sens_analysis_3/onscoviddeath_univar_ethn.ster"
        data2: "output/warfarin_tempdata/sens_analysis_3/onscoviddeath_multivar1_ethn.ster"
        data3: "output/warfarin_tempdata/sens_analysis_3/onscoviddeath_multivar2_ethn.ster"
        data4: "output/warfarin_tempdata/sens_analysis_3/onscoviddeath_multivar2_withoutethn.ster"
        data5: "output/warfarin_tempdata/sens_analysis_3/onscoviddeath_multivar3_ethn.ster"
        data6: "output/warfarin_tempdata/sens_analysis_3/onscoviddeath_multivar3_withoutethn.ster"

  # Primary Outcomes: COVID-19 hospital admission
  SA3_02b_cr_create_population_af_warfarin_admitcovid:
    run: stata-mp:latest analysis/SA3_02b_cr_create_population.do admitcovid SA3_af_warfarin
    needs: [02b_cr_create_population_af_warfarin_admitcovid]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/sens_analysis_3/SA3_02b_cr_create_population_admitcovid.log
      highly_sensitive:
        data1: "output/warfarin_tempdata/sens_analysis_3/analysis_dataset_admitcovid.dta"
        data2: "output/warfarin_tempdata/sens_analysis_3/analysis_dataset_STSET_admitcovid.dta"

  SA3_05b_an_models_af_warfarin_admitcovid:
    run: stata-mp:latest analysis/05b_an_models.do admitcovid SA3_af_warfarin
    needs: [SA3_02b_cr_create_population_af_warfarin_admitcovid, 05b_an_models_af_warfarin_admitcovid]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/sens_analysis_3/05b_an_models_admitcovid.log
        table: "output/warfarin_tabfig/sens_analysis_3/table2_admitcovid.txt"
      highly_sensitive:
        data1: "output/warfarin_tempdata/sens_analysis_3/admitcovid_univar.ster"
        data2: "output/warfarin_tempdata/sens_analysis_3/admitcovid_multivar1.ster"
        data3: "output/warfarin_tempdata/sens_analysis_3/admitcovid_multivar2.ster"
        data4: "output/warfarin_tempdata/sens_analysis_3/admitcovid_multivar3.ster"

  SA3_06b_an_models_ethnicity_af_warfarin_admitcovid:
    run: stata-mp:latest analysis/06b_an_models_ethnicity.do admitcovid SA3_af_warfarin
    needs: [SA3_02b_cr_create_population_af_warfarin_admitcovid, 06b_an_models_ethnicity_af_warfarin_admitcovid]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/sens_analysis_3/06b_an_models_ethnicity_admitcovid.log
        table: "output/warfarin_tabfig/sens_analysis_3/table3_admitcovid.txt"
      highly_sensitive:
        data1: "output/warfarin_tempdata/sens_analysis_3/admitcovid_univar_ethn.ster"
        data2: "output/warfarin_tempdata/sens_analysis_3/admitcovid_multivar1_ethn.ster"
        data3: "output/warfarin_tempdata/sens_analysis_3/admitcovid_multivar2_ethn.ster"
        data4: "output/warfarin_tempdata/sens_analysis_3/admitcovid_multivar2_withoutethn.ster"
        data5: "output/warfarin_tempdata/sens_analysis_3/admitcovid_multivar3_ethn.ster"
        data6: "output/warfarin_tempdata/sens_analysis_3/admitcovid_multivar3_withoutethn.ster"

    # Exploratory Outcomes: Non-COVID death
  SA3_02b_cr_create_population_af_warfarin_onsnoncoviddeath:
    run: stata-mp:latest analysis/SA3_02b_cr_create_population.do onsnoncoviddeath SA3_af_warfarin
    needs: [02b_cr_create_population_af_warfarin_onsnoncoviddeath]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/sens_analysis_3/SA3_02b_cr_create_population_onsnoncoviddeath.log
      highly_sensitive:
        data1: "output/warfarin_tempdata/sens_analysis_3/analysis_dataset_onsnoncoviddeath.dta"
        data2: "output/warfarin_tempdata/sens_analysis_3/analysis_dataset_STSET_onsnoncoviddeath.dta"

  SA3_05b_an_models_af_warfarin_onsnoncoviddeath:
    run: stata-mp:latest analysis/05b_an_models.do onsnoncoviddeath SA3_af_warfarin
    needs: [SA3_02b_cr_create_population_af_warfarin_onsnoncoviddeath, 05b_an_models_af_warfarin_onsnoncoviddeath]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/sens_analysis_3/05b_an_models_onsnoncoviddeath.log
        table: "output/warfarin_tabfig/sens_analysis_3/table2_onsnoncoviddeath.txt"
      highly_sensitive:
        data1: "output/warfarin_tempdata/sens_analysis_3/onsnoncoviddeath_univar.ster"
        data2: "output/warfarin_tempdata/sens_analysis_3/onsnoncoviddeath_multivar1.ster"
        data3: "output/warfarin_tempdata/sens_analysis_3/onsnoncoviddeath_multivar2.ster"
        data4: "output/warfarin_tempdata/sens_analysis_3/onsnoncoviddeath_multivar3.ster"

  SA3_06b_an_models_ethnicity_af_warfarin_onsnoncoviddeath:
    run: stata-mp:latest analysis/06b_an_models_ethnicity.do onsnoncoviddeath SA3_af_warfarin
    needs: [SA3_02b_cr_create_population_af_warfarin_onsnoncoviddeath, 06b_an_models_ethnicity_af_warfarin_onsnoncoviddeath]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/sens_analysis_3/06b_an_models_ethnicity_onsnoncoviddeath.log
        table: "output/warfarin_tabfig/sens_analysis_3/table3_onsnoncoviddeath.txt"
      highly_sensitive:
        data1: "output/warfarin_tempdata/sens_analysis_3/onsnoncoviddeath_univar_ethn.ster"
        data2: "output/warfarin_tempdata/sens_analysis_3/onsnoncoviddeath_multivar1_ethn.ster"
        data3: "output/warfarin_tempdata/sens_analysis_3/onsnoncoviddeath_multivar2_ethn.ster"
        data4: "output/warfarin_tempdata/sens_analysis_3/onsnoncoviddeath_multivar2_withoutethn.ster"
        data5: "output/warfarin_tempdata/sens_analysis_3/onsnoncoviddeath_multivar3_ethn.ster"
        data6: "output/warfarin_tempdata/sens_analysis_3/onsnoncoviddeath_multivar3_withoutethn.ster"
        
  # Exploratory Outcomes: COVID-19 test
  SA3_02b_cr_create_population_af_warfarin_covidtest:
    run: stata-mp:latest analysis/SA3_02b_cr_create_population.do covidtest SA3_af_warfarin
    needs: [02b_cr_create_population_af_warfarin_covidtest]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/sens_analysis_3/SA3_02b_cr_create_population_covidtest.log
      highly_sensitive:
        data1: "output/warfarin_tempdata/sens_analysis_3/analysis_dataset_covidtest.dta"
        data2: "output/warfarin_tempdata/sens_analysis_3/analysis_dataset_STSET_covidtest.dta"

  SA3_05b_an_models_af_warfarin_covidtest:
    run: stata-mp:latest analysis/05b_an_models.do covidtest SA3_af_warfarin
    needs: [SA3_02b_cr_create_population_af_warfarin_covidtest, 05b_an_models_af_warfarin_covidtest]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/sens_analysis_3/05b_an_models_covidtest.log
        table: "output/warfarin_tabfig/sens_analysis_3/table2_covidtest.txt"
      highly_sensitive:
        data1: "output/warfarin_tempdata/sens_analysis_3/covidtest_univar.ster"
        data2: "output/warfarin_tempdata/sens_analysis_3/covidtest_multivar1.ster"
        data3: "output/warfarin_tempdata/sens_analysis_3/covidtest_multivar2.ster"
        data4: "output/warfarin_tempdata/sens_analysis_3/covidtest_multivar3.ster"

  SA3_06b_an_models_ethnicity_af_warfarin_covidtest:
    run: stata-mp:latest analysis/06b_an_models_ethnicity.do covidtest SA3_af_warfarin
    needs: [SA3_02b_cr_create_population_af_warfarin_covidtest, 06b_an_models_ethnicity_af_warfarin_covidtest]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/sens_analysis_3/06b_an_models_ethnicity_covidtest.log
        table: "output/warfarin_tabfig/sens_analysis_3/table3_covidtest.txt"
      highly_sensitive:
        data1: "output/warfarin_tempdata/sens_analysis_3/covidtest_univar_ethn.ster"
        data2: "output/warfarin_tempdata/sens_analysis_3/covidtest_multivar1_ethn.ster"
        data3: "output/warfarin_tempdata/sens_analysis_3/covidtest_multivar2_ethn.ster"
        data4: "output/warfarin_tempdata/sens_analysis_3/covidtest_multivar2_withoutethn.ster"
        data5: "output/warfarin_tempdata/sens_analysis_3/covidtest_multivar3_ethn.ster"
        data6: "output/warfarin_tempdata/sens_analysis_3/covidtest_multivar3_withoutethn.ster"

  # Exploratory Outcomes: Positive COVID test
  SA3_02b_cr_create_population_af_warfarin_positivecovidtest:
    run: stata-mp:latest analysis/SA3_02b_cr_create_population.do positivecovidtest SA3_af_warfarin
    needs: [02b_cr_create_population_af_warfarin_positivecovidtest]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/sens_analysis_3/SA3_02b_cr_create_population_positivecovidtest.log
      highly_sensitive:
        data1: "output/warfarin_tempdata/sens_analysis_3/analysis_dataset_positivecovidtest.dta"
        data2: "output/warfarin_tempdata/sens_analysis_3/analysis_dataset_STSET_positivecovidtest.dta"

  SA3_05b_an_models_af_warfarin_positivecovidtest:
    run: stata-mp:latest analysis/05b_an_models.do positivecovidtest SA3_af_warfarin
    needs: [SA3_02b_cr_create_population_af_warfarin_positivecovidtest, 05b_an_models_af_warfarin_positivecovidtest]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/sens_analysis_3/05b_an_models_positivecovidtest.log
        table: "output/warfarin_tabfig/sens_analysis_3/table2_positivecovidtest.txt"
      highly_sensitive:
        data1: "output/warfarin_tempdata/sens_analysis_3/positivecovidtest_univar.ster"
        data2: "output/warfarin_tempdata/sens_analysis_3/positivecovidtest_multivar1.ster"
        data3: "output/warfarin_tempdata/sens_analysis_3/positivecovidtest_multivar2.ster"
        data4: "output/warfarin_tempdata/sens_analysis_3/positivecovidtest_multivar3.ster"

  SA3_06b_an_models_ethnicity_af_warfarin_positivecovidtest:
    run: stata-mp:latest analysis/06b_an_models_ethnicity.do positivecovidtest SA3_af_warfarin
    needs: [SA3_02b_cr_create_population_af_warfarin_positivecovidtest, 06b_an_models_ethnicity_af_warfarin_positivecovidtest]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/sens_analysis_3/06b_an_models_ethnicity_positivecovidtest.log
        table: "output/warfarin_tabfig/sens_analysis_3/table3_positivecovidtest.txt"
      highly_sensitive:
        data1: "output/warfarin_tempdata/sens_analysis_3/positivecovidtest_univar_ethn.ster"
        data2: "output/warfarin_tempdata/sens_analysis_3/positivecovidtest_multivar1_ethn.ster"
        data3: "output/warfarin_tempdata/sens_analysis_3/positivecovidtest_multivar2_ethn.ster"
        data4: "output/warfarin_tempdata/sens_analysis_3/positivecovidtest_multivar2_withoutethn.ster"
        data5: "output/warfarin_tempdata/sens_analysis_3/positivecovidtest_multivar3_ethn.ster"
        data6: "output/warfarin_tempdata/sens_analysis_3/positivecovidtest_multivar3_withoutethn.ster"

  # Sensitivity Analysis 4
  # Exclude people who ever had warfarin prescription 4 months before cohort entry in the DOAC group
  # Objective 2: Compare warfarin users and DOAC users

  # Primary Outcomes: ONS COVID-19 death
  SA4_02b_cr_create_population_af_warfarin_onscoviddeath:
    run: stata-mp:latest analysis/SA4_02b_cr_create_population.do onscoviddeath SA4_af_warfarin
    needs: [02b_cr_create_population_af_warfarin_onscoviddeath]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/sens_analysis_4/SA4_02b_cr_create_population_onscoviddeath.log
      highly_sensitive:
        data1: "output/warfarin_tempdata/sens_analysis_4/analysis_dataset_onscoviddeath.dta"
        data2: "output/warfarin_tempdata/sens_analysis_4/analysis_dataset_STSET_onscoviddeath.dta"

  SA4_05b_an_models_af_warfarin_onscoviddeath:
    run: stata-mp:latest analysis/05b_an_models.do onscoviddeath SA4_af_warfarin
    needs: [SA4_02b_cr_create_population_af_warfarin_onscoviddeath, 05b_an_models_af_warfarin_onscoviddeath]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/sens_analysis_4/05b_an_models_onscoviddeath.log
        table: "output/warfarin_tabfig/sens_analysis_4/table2_onscoviddeath.txt"
      highly_sensitive:
        data1: "output/warfarin_tempdata/sens_analysis_4/onscoviddeath_univar.ster"
        data2: "output/warfarin_tempdata/sens_analysis_4/onscoviddeath_multivar1.ster"
        data3: "output/warfarin_tempdata/sens_analysis_4/onscoviddeath_multivar2.ster"
        data4: "output/warfarin_tempdata/sens_analysis_4/onscoviddeath_multivar3.ster"

  SA4_06b_an_models_ethnicity_af_warfarin_onscoviddeath:
    run: stata-mp:latest analysis/06b_an_models_ethnicity.do onscoviddeath SA4_af_warfarin
    needs: [SA4_02b_cr_create_population_af_warfarin_onscoviddeath, 06b_an_models_ethnicity_af_warfarin_onscoviddeath]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/sens_analysis_4/06b_an_models_ethnicity_onscoviddeath.log
        table: "output/warfarin_tabfig/sens_analysis_4/table3_onscoviddeath.txt"
      highly_sensitive:
        data1: "output/warfarin_tempdata/sens_analysis_4/onscoviddeath_univar_ethn.ster"
        data2: "output/warfarin_tempdata/sens_analysis_4/onscoviddeath_multivar1_ethn.ster"
        data3: "output/warfarin_tempdata/sens_analysis_4/onscoviddeath_multivar2_ethn.ster"
        data4: "output/warfarin_tempdata/sens_analysis_4/onscoviddeath_multivar2_withoutethn.ster"
        data5: "output/warfarin_tempdata/sens_analysis_4/onscoviddeath_multivar3_ethn.ster"
        data6: "output/warfarin_tempdata/sens_analysis_4/onscoviddeath_multivar3_withoutethn.ster"

  # Primary Outcomes: COVID-19 hospital admission
  SA4_02b_cr_create_population_af_warfarin_admitcovid:
    run: stata-mp:latest analysis/SA4_02b_cr_create_population.do admitcovid SA4_af_warfarin
    needs: [02b_cr_create_population_af_warfarin_admitcovid]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/sens_analysis_4/SA4_02b_cr_create_population_admitcovid.log
      highly_sensitive:
        data1: "output/warfarin_tempdata/sens_analysis_4/analysis_dataset_admitcovid.dta"
        data2: "output/warfarin_tempdata/sens_analysis_4/analysis_dataset_STSET_admitcovid.dta"

  SA4_05b_an_models_af_warfarin_admitcovid:
    run: stata-mp:latest analysis/05b_an_models.do admitcovid SA4_af_warfarin
    needs: [SA4_02b_cr_create_population_af_warfarin_admitcovid, 05b_an_models_af_warfarin_admitcovid]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/sens_analysis_4/05b_an_models_admitcovid.log
        table: "output/warfarin_tabfig/sens_analysis_4/table2_admitcovid.txt"
      highly_sensitive:
        data1: "output/warfarin_tempdata/sens_analysis_4/admitcovid_univar.ster"
        data2: "output/warfarin_tempdata/sens_analysis_4/admitcovid_multivar1.ster"
        data3: "output/warfarin_tempdata/sens_analysis_4/admitcovid_multivar2.ster"
        data4: "output/warfarin_tempdata/sens_analysis_4/admitcovid_multivar3.ster"

  SA4_06b_an_models_ethnicity_af_warfarin_admitcovid:
    run: stata-mp:latest analysis/06b_an_models_ethnicity.do admitcovid SA4_af_warfarin
    needs: [SA4_02b_cr_create_population_af_warfarin_admitcovid, 06b_an_models_ethnicity_af_warfarin_admitcovid]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/sens_analysis_4/06b_an_models_ethnicity_admitcovid.log
        table: "output/warfarin_tabfig/sens_analysis_4/table3_admitcovid.txt"
      highly_sensitive:
        data1: "output/warfarin_tempdata/sens_analysis_4/admitcovid_univar_ethn.ster"
        data2: "output/warfarin_tempdata/sens_analysis_4/admitcovid_multivar1_ethn.ster"
        data3: "output/warfarin_tempdata/sens_analysis_4/admitcovid_multivar2_ethn.ster"
        data4: "output/warfarin_tempdata/sens_analysis_4/admitcovid_multivar2_withoutethn.ster"
        data5: "output/warfarin_tempdata/sens_analysis_4/admitcovid_multivar3_ethn.ster"
        data6: "output/warfarin_tempdata/sens_analysis_4/admitcovid_multivar3_withoutethn.ster"

    # Exploratory Outcomes: Non-COVID death
  SA4_02b_cr_create_population_af_warfarin_onsnoncoviddeath:
    run: stata-mp:latest analysis/SA4_02b_cr_create_population.do onsnoncoviddeath SA4_af_warfarin
    needs: [02b_cr_create_population_af_warfarin_onsnoncoviddeath]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/sens_analysis_4/SA4_02b_cr_create_population_onsnoncoviddeath.log
      highly_sensitive:
        data1: "output/warfarin_tempdata/sens_analysis_4/analysis_dataset_onsnoncoviddeath.dta"
        data2: "output/warfarin_tempdata/sens_analysis_4/analysis_dataset_STSET_onsnoncoviddeath.dta"

  SA4_05b_an_models_af_warfarin_onsnoncoviddeath:
    run: stata-mp:latest analysis/05b_an_models.do onsnoncoviddeath SA4_af_warfarin
    needs: [SA4_02b_cr_create_population_af_warfarin_onsnoncoviddeath, 05b_an_models_af_warfarin_onsnoncoviddeath]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/sens_analysis_4/05b_an_models_onsnoncoviddeath.log
        table: "output/warfarin_tabfig/sens_analysis_4/table2_onsnoncoviddeath.txt"
      highly_sensitive:
        data1: "output/warfarin_tempdata/sens_analysis_4/onsnoncoviddeath_univar.ster"
        data2: "output/warfarin_tempdata/sens_analysis_4/onsnoncoviddeath_multivar1.ster"
        data3: "output/warfarin_tempdata/sens_analysis_4/onsnoncoviddeath_multivar2.ster"
        data4: "output/warfarin_tempdata/sens_analysis_4/onsnoncoviddeath_multivar3.ster"

  SA4_06b_an_models_ethnicity_af_warfarin_onsnoncoviddeath:
    run: stata-mp:latest analysis/06b_an_models_ethnicity.do onsnoncoviddeath SA4_af_warfarin
    needs: [SA4_02b_cr_create_population_af_warfarin_onsnoncoviddeath, 06b_an_models_ethnicity_af_warfarin_onsnoncoviddeath]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/sens_analysis_4/06b_an_models_ethnicity_onsnoncoviddeath.log
        table: "output/warfarin_tabfig/sens_analysis_4/table3_onsnoncoviddeath.txt"
      highly_sensitive:
        data1: "output/warfarin_tempdata/sens_analysis_4/onsnoncoviddeath_univar_ethn.ster"
        data2: "output/warfarin_tempdata/sens_analysis_4/onsnoncoviddeath_multivar1_ethn.ster"
        data3: "output/warfarin_tempdata/sens_analysis_4/onsnoncoviddeath_multivar2_ethn.ster"
        data4: "output/warfarin_tempdata/sens_analysis_4/onsnoncoviddeath_multivar2_withoutethn.ster"
        data5: "output/warfarin_tempdata/sens_analysis_4/onsnoncoviddeath_multivar3_ethn.ster"
        data6: "output/warfarin_tempdata/sens_analysis_4/onsnoncoviddeath_multivar3_withoutethn.ster"
        
  # Exploratory Outcomes: COVID-19 test
  SA4_02b_cr_create_population_af_warfarin_covidtest:
    run: stata-mp:latest analysis/SA4_02b_cr_create_population.do covidtest SA4_af_warfarin
    needs: [02b_cr_create_population_af_warfarin_covidtest]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/sens_analysis_4/SA4_02b_cr_create_population_covidtest.log
      highly_sensitive:
        data1: "output/warfarin_tempdata/sens_analysis_4/analysis_dataset_covidtest.dta"
        data2: "output/warfarin_tempdata/sens_analysis_4/analysis_dataset_STSET_covidtest.dta"

  SA4_05b_an_models_af_warfarin_covidtest:
    run: stata-mp:latest analysis/05b_an_models.do covidtest SA4_af_warfarin
    needs: [SA4_02b_cr_create_population_af_warfarin_covidtest, 05b_an_models_af_warfarin_covidtest]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/sens_analysis_4/05b_an_models_covidtest.log
        table: "output/warfarin_tabfig/sens_analysis_4/table2_covidtest.txt"
      highly_sensitive:
        data1: "output/warfarin_tempdata/sens_analysis_4/covidtest_univar.ster"
        data2: "output/warfarin_tempdata/sens_analysis_4/covidtest_multivar1.ster"
        data3: "output/warfarin_tempdata/sens_analysis_4/covidtest_multivar2.ster"
        data4: "output/warfarin_tempdata/sens_analysis_4/covidtest_multivar3.ster"

  SA4_06b_an_models_ethnicity_af_warfarin_covidtest:
    run: stata-mp:latest analysis/06b_an_models_ethnicity.do covidtest SA4_af_warfarin
    needs: [SA4_02b_cr_create_population_af_warfarin_covidtest, 06b_an_models_ethnicity_af_warfarin_covidtest]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/sens_analysis_4/06b_an_models_ethnicity_covidtest.log
        table: "output/warfarin_tabfig/sens_analysis_4/table3_covidtest.txt"
      highly_sensitive:
        data1: "output/warfarin_tempdata/sens_analysis_4/covidtest_univar_ethn.ster"
        data2: "output/warfarin_tempdata/sens_analysis_4/covidtest_multivar1_ethn.ster"
        data3: "output/warfarin_tempdata/sens_analysis_4/covidtest_multivar2_ethn.ster"
        data4: "output/warfarin_tempdata/sens_analysis_4/covidtest_multivar2_withoutethn.ster"
        data5: "output/warfarin_tempdata/sens_analysis_4/covidtest_multivar3_ethn.ster"
        data6: "output/warfarin_tempdata/sens_analysis_4/covidtest_multivar3_withoutethn.ster"

  # Exploratory Outcomes: Positive COVID test
  SA4_02b_cr_create_population_af_warfarin_positivecovidtest:
    run: stata-mp:latest analysis/SA4_02b_cr_create_population.do positivecovidtest SA4_af_warfarin
    needs: [02b_cr_create_population_af_warfarin_positivecovidtest]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/sens_analysis_4/SA4_02b_cr_create_population_positivecovidtest.log
      highly_sensitive:
        data1: "output/warfarin_tempdata/sens_analysis_4/analysis_dataset_positivecovidtest.dta"
        data2: "output/warfarin_tempdata/sens_analysis_4/analysis_dataset_STSET_positivecovidtest.dta"

  SA4_05b_an_models_af_warfarin_positivecovidtest:
    run: stata-mp:latest analysis/05b_an_models.do positivecovidtest SA4_af_warfarin
    needs: [SA4_02b_cr_create_population_af_warfarin_positivecovidtest, 05b_an_models_af_warfarin_positivecovidtest]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/sens_analysis_4/05b_an_models_positivecovidtest.log
        table: "output/warfarin_tabfig/sens_analysis_4/table2_positivecovidtest.txt"
      highly_sensitive:
        data1: "output/warfarin_tempdata/sens_analysis_4/positivecovidtest_univar.ster"
        data2: "output/warfarin_tempdata/sens_analysis_4/positivecovidtest_multivar1.ster"
        data3: "output/warfarin_tempdata/sens_analysis_4/positivecovidtest_multivar2.ster"
        data4: "output/warfarin_tempdata/sens_analysis_4/positivecovidtest_multivar3.ster"

  SA4_06b_an_models_ethnicity_af_warfarin_positivecovidtest:
    run: stata-mp:latest analysis/06b_an_models_ethnicity.do positivecovidtest SA4_af_warfarin
    needs: [SA4_02b_cr_create_population_af_warfarin_positivecovidtest, 06b_an_models_ethnicity_af_warfarin_positivecovidtest]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/sens_analysis_4/06b_an_models_ethnicity_positivecovidtest.log
        table: "output/warfarin_tabfig/sens_analysis_4/table3_positivecovidtest.txt"
      highly_sensitive:
        data1: "output/warfarin_tempdata/sens_analysis_4/positivecovidtest_univar_ethn.ster"
        data2: "output/warfarin_tempdata/sens_analysis_4/positivecovidtest_multivar1_ethn.ster"
        data3: "output/warfarin_tempdata/sens_analysis_4/positivecovidtest_multivar2_ethn.ster"
        data4: "output/warfarin_tempdata/sens_analysis_4/positivecovidtest_multivar2_withoutethn.ster"
        data5: "output/warfarin_tempdata/sens_analysis_4/positivecovidtest_multivar3_ethn.ster"
        data6: "output/warfarin_tempdata/sens_analysis_4/positivecovidtest_multivar3_withoutethn.ster"

  # Sensitivity Analysis 5
  # Use time-updated exposure variable (warfarin/DOACs) 
  # Objective 2: Compare warfarin users and DOAC users

  # Primary Outcomes: ONS COVID-19 death
  SA5_02b_cr_create_population_af_warfarin_onscoviddeath:
    run: stata-mp:latest analysis/SA5_02b_cr_create_population.do onscoviddeath SA5_af_warfarin
    needs: [02b_cr_create_population_af_warfarin_onscoviddeath]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/sens_analysis_5/SA5_02b_cr_create_population_onscoviddeath.log
      highly_sensitive:
        data1: "output/warfarin_tempdata/sens_analysis_5/last_date_onscoviddeath.dta"
        data2: "output/warfarin_tempdata/sens_analysis_5/warfarin_rx_onscoviddeath.dta"
        data3: "output/warfarin_tempdata/sens_analysis_5/doac_rx_onscoviddeath.dta"
        data4: "output/warfarin_tempdata/sens_analysis_5/oac_rx_onscoviddeath.dta"
        data5: "output/warfarin_tempdata/sens_analysis_5/analysis_dataset_STSET_onscoviddeath.dta"

  SA5_03b_an_checks_onscoviddeath:
    run: stata-mp:latest analysis/SA5_03b_an_checks.do SA5_af_warfarin onscoviddeath
    needs: [SA5_02b_cr_create_population_af_warfarin_onscoviddeath, SA5_05b_an_models_af_warfarin_onscoviddeath]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/sens_analysis_5/SA5_03b_an_checks_onscoviddeath.log
        table: "output/warfarin_tabfig/sens_analysis_5/time_updated_onscoviddeath.txt"

  SA5_05b_an_models_af_warfarin_onscoviddeath:
    run: stata-mp:latest analysis/05b_an_models.do onscoviddeath SA5_af_warfarin
    needs: [SA5_02b_cr_create_population_af_warfarin_onscoviddeath, 05b_an_models_af_warfarin_onscoviddeath]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/sens_analysis_5/05b_an_models_onscoviddeath.log
        table: "output/warfarin_tabfig/sens_analysis_5/table2_onscoviddeath.txt"
      highly_sensitive:
        data1: "output/warfarin_tempdata/sens_analysis_5/onscoviddeath_univar.ster"
        data2: "output/warfarin_tempdata/sens_analysis_5/onscoviddeath_multivar1.ster"
        data3: "output/warfarin_tempdata/sens_analysis_5/onscoviddeath_multivar2.ster"
        data4: "output/warfarin_tempdata/sens_analysis_5/onscoviddeath_multivar3.ster"

  SA5_06b_an_models_ethnicity_af_warfarin_onscoviddeath:
    run: stata-mp:latest analysis/06b_an_models_ethnicity.do onscoviddeath SA5_af_warfarin
    needs: [SA5_02b_cr_create_population_af_warfarin_onscoviddeath, 06b_an_models_ethnicity_af_warfarin_onscoviddeath]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/sens_analysis_5/06b_an_models_ethnicity_onscoviddeath.log
        table: "output/warfarin_tabfig/sens_analysis_5/table3_onscoviddeath.txt"
      highly_sensitive:
        data1: "output/warfarin_tempdata/sens_analysis_5/onscoviddeath_univar_ethn.ster"
        data2: "output/warfarin_tempdata/sens_analysis_5/onscoviddeath_multivar1_ethn.ster"
        data3: "output/warfarin_tempdata/sens_analysis_5/onscoviddeath_multivar2_ethn.ster"
        data4: "output/warfarin_tempdata/sens_analysis_5/onscoviddeath_multivar2_withoutethn.ster"
        data5: "output/warfarin_tempdata/sens_analysis_5/onscoviddeath_multivar3_ethn.ster"
        data6: "output/warfarin_tempdata/sens_analysis_5/onscoviddeath_multivar3_withoutethn.ster"

  # Primary Outcomes: COVID-19 hospital admission
  SA5_02b_cr_create_population_af_warfarin_admitcovid:
    run: stata-mp:latest analysis/SA5_02b_cr_create_population.do admitcovid SA5_af_warfarin
    needs: [02b_cr_create_population_af_warfarin_admitcovid]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/sens_analysis_5/SA5_02b_cr_create_population_admitcovid.log
      highly_sensitive:
        data1: "output/warfarin_tempdata/sens_analysis_5/last_date_admitcovid.dta"
        data2: "output/warfarin_tempdata/sens_analysis_5/warfarin_rx_admitcovid.dta"
        data3: "output/warfarin_tempdata/sens_analysis_5/doac_rx_admitcovid.dta"
        data4: "output/warfarin_tempdata/sens_analysis_5/oac_rx_admitcovid.dta"
        data5: "output/warfarin_tempdata/sens_analysis_5/analysis_dataset_STSET_admitcovid.dta"

  SA5_03b_an_checks_admitcovid:
    run: stata-mp:latest analysis/SA5_03b_an_checks.do SA5_af_warfarin admitcovid
    needs: [SA5_02b_cr_create_population_af_warfarin_admitcovid, SA5_05b_an_models_af_warfarin_admitcovid]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/sens_analysis_5/SA5_03b_an_checks_admitcovid.log
        table: "output/warfarin_tabfig/sens_analysis_5/time_updated_admitcovid.txt"

  SA5_05b_an_models_af_warfarin_admitcovid:
    run: stata-mp:latest analysis/05b_an_models.do admitcovid SA5_af_warfarin
    needs: [SA5_02b_cr_create_population_af_warfarin_admitcovid, 05b_an_models_af_warfarin_admitcovid]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/sens_analysis_5/05b_an_models_admitcovid.log
        table: "output/warfarin_tabfig/sens_analysis_5/table2_admitcovid.txt"
      highly_sensitive:
        data1: "output/warfarin_tempdata/sens_analysis_5/admitcovid_univar.ster"
        data2: "output/warfarin_tempdata/sens_analysis_5/admitcovid_multivar1.ster"
        data3: "output/warfarin_tempdata/sens_analysis_5/admitcovid_multivar2.ster"
        data4: "output/warfarin_tempdata/sens_analysis_5/admitcovid_multivar3.ster"

  SA5_06b_an_models_ethnicity_af_warfarin_admitcovid:
    run: stata-mp:latest analysis/06b_an_models_ethnicity.do admitcovid SA5_af_warfarin
    needs: [SA5_02b_cr_create_population_af_warfarin_admitcovid, 06b_an_models_ethnicity_af_warfarin_admitcovid]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/sens_analysis_5/06b_an_models_ethnicity_admitcovid.log
        table: "output/warfarin_tabfig/sens_analysis_5/table3_admitcovid.txt"
      highly_sensitive:
        data1: "output/warfarin_tempdata/sens_analysis_5/admitcovid_univar_ethn.ster"
        data2: "output/warfarin_tempdata/sens_analysis_5/admitcovid_multivar1_ethn.ster"
        data3: "output/warfarin_tempdata/sens_analysis_5/admitcovid_multivar2_ethn.ster"
        data4: "output/warfarin_tempdata/sens_analysis_5/admitcovid_multivar2_withoutethn.ster"
        data5: "output/warfarin_tempdata/sens_analysis_5/admitcovid_multivar3_ethn.ster"
        data6: "output/warfarin_tempdata/sens_analysis_5/admitcovid_multivar3_withoutethn.ster"

    # Exploratory Outcomes: Non-COVID death
  SA5_02b_cr_create_population_af_warfarin_onsnoncoviddeath:
    run: stata-mp:latest analysis/SA5_02b_cr_create_population.do onsnoncoviddeath SA5_af_warfarin
    needs: [02b_cr_create_population_af_warfarin_onsnoncoviddeath]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/sens_analysis_5/SA5_02b_cr_create_population_onsnoncoviddeath.log
      highly_sensitive:
        data1: "output/warfarin_tempdata/sens_analysis_5/last_date_onsnoncoviddeath.dta"
        data2: "output/warfarin_tempdata/sens_analysis_5/warfarin_rx_onsnoncoviddeath.dta"
        data3: "output/warfarin_tempdata/sens_analysis_5/doac_rx_onsnoncoviddeath.dta"
        data4: "output/warfarin_tempdata/sens_analysis_5/oac_rx_onsnoncoviddeath.dta"
        data5: "output/warfarin_tempdata/sens_analysis_5/analysis_dataset_STSET_onsnoncoviddeath.dta"

  SA5_03b_an_checks_onsnoncoviddeath:
    run: stata-mp:latest analysis/SA5_03b_an_checks.do SA5_af_warfarin onsnoncoviddeath
    needs: [SA5_02b_cr_create_population_af_warfarin_onsnoncoviddeath, SA5_05b_an_models_af_warfarin_onsnoncoviddeath]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/sens_analysis_5/SA5_03b_an_checks_onsnoncoviddeath.log
        table: "output/warfarin_tabfig/sens_analysis_5/time_updated_onsnoncoviddeath.txt"

  SA5_05b_an_models_af_warfarin_onsnoncoviddeath:
    run: stata-mp:latest analysis/05b_an_models.do onsnoncoviddeath SA5_af_warfarin
    needs: [SA5_02b_cr_create_population_af_warfarin_onsnoncoviddeath, 05b_an_models_af_warfarin_onsnoncoviddeath]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/sens_analysis_5/05b_an_models_onsnoncoviddeath.log
        table: "output/warfarin_tabfig/sens_analysis_5/table2_onsnoncoviddeath.txt"
      highly_sensitive:
        data1: "output/warfarin_tempdata/sens_analysis_5/onsnoncoviddeath_univar.ster"
        data2: "output/warfarin_tempdata/sens_analysis_5/onsnoncoviddeath_multivar1.ster"
        data3: "output/warfarin_tempdata/sens_analysis_5/onsnoncoviddeath_multivar2.ster"
        data4: "output/warfarin_tempdata/sens_analysis_5/onsnoncoviddeath_multivar3.ster"

  SA5_06b_an_models_ethnicity_af_warfarin_onsnoncoviddeath:
    run: stata-mp:latest analysis/06b_an_models_ethnicity.do onsnoncoviddeath SA5_af_warfarin
    needs: [SA5_02b_cr_create_population_af_warfarin_onsnoncoviddeath, 06b_an_models_ethnicity_af_warfarin_onsnoncoviddeath]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/sens_analysis_5/06b_an_models_ethnicity_onsnoncoviddeath.log
        table: "output/warfarin_tabfig/sens_analysis_5/table3_onsnoncoviddeath.txt"
      highly_sensitive:
        data1: "output/warfarin_tempdata/sens_analysis_5/onsnoncoviddeath_univar_ethn.ster"
        data2: "output/warfarin_tempdata/sens_analysis_5/onsnoncoviddeath_multivar1_ethn.ster"
        data3: "output/warfarin_tempdata/sens_analysis_5/onsnoncoviddeath_multivar2_ethn.ster"
        data4: "output/warfarin_tempdata/sens_analysis_5/onsnoncoviddeath_multivar2_withoutethn.ster"
        data5: "output/warfarin_tempdata/sens_analysis_5/onsnoncoviddeath_multivar3_ethn.ster"
        data6: "output/warfarin_tempdata/sens_analysis_5/onsnoncoviddeath_multivar3_withoutethn.ster"
        
  # Exploratory Outcomes: COVID-19 test
  SA5_02b_cr_create_population_af_warfarin_covidtest:
    run: stata-mp:latest analysis/SA5_02b_cr_create_population.do covidtest SA5_af_warfarin
    needs: [02b_cr_create_population_af_warfarin_covidtest]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/sens_analysis_5/SA5_02b_cr_create_population_covidtest.log
      highly_sensitive:
        data1: "output/warfarin_tempdata/sens_analysis_5/last_date_covidtest.dta"
        data2: "output/warfarin_tempdata/sens_analysis_5/warfarin_rx_covidtest.dta"
        data3: "output/warfarin_tempdata/sens_analysis_5/doac_rx_covidtest.dta"
        data4: "output/warfarin_tempdata/sens_analysis_5/oac_rx_covidtest.dta"
        data5: "output/warfarin_tempdata/sens_analysis_5/analysis_dataset_STSET_covidtest.dta"

  SA5_03b_an_checks_covidtest:
    run: stata-mp:latest analysis/SA5_03b_an_checks.do SA5_af_warfarin covidtest
    needs: [SA5_02b_cr_create_population_af_warfarin_covidtest, SA5_05b_an_models_af_warfarin_covidtest]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/sens_analysis_5/SA5_03b_an_checks_covidtest.log
        table: "output/warfarin_tabfig/sens_analysis_5/time_updated_covidtest.txt"

  SA5_05b_an_models_af_warfarin_covidtest:
    run: stata-mp:latest analysis/05b_an_models.do covidtest SA5_af_warfarin
    needs: [SA5_02b_cr_create_population_af_warfarin_covidtest, 05b_an_models_af_warfarin_covidtest]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/sens_analysis_5/05b_an_models_covidtest.log
        table: "output/warfarin_tabfig/sens_analysis_5/table2_covidtest.txt"
      highly_sensitive:
        data1: "output/warfarin_tempdata/sens_analysis_5/covidtest_univar.ster"
        data2: "output/warfarin_tempdata/sens_analysis_5/covidtest_multivar1.ster"
        data3: "output/warfarin_tempdata/sens_analysis_5/covidtest_multivar2.ster"
        data4: "output/warfarin_tempdata/sens_analysis_5/covidtest_multivar3.ster"

  SA5_06b_an_models_ethnicity_af_warfarin_covidtest:
    run: stata-mp:latest analysis/06b_an_models_ethnicity.do covidtest SA5_af_warfarin
    needs: [SA5_02b_cr_create_population_af_warfarin_covidtest, 06b_an_models_ethnicity_af_warfarin_covidtest]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/sens_analysis_5/06b_an_models_ethnicity_covidtest.log
        table: "output/warfarin_tabfig/sens_analysis_5/table3_covidtest.txt"
      highly_sensitive:
        data1: "output/warfarin_tempdata/sens_analysis_5/covidtest_univar_ethn.ster"
        data2: "output/warfarin_tempdata/sens_analysis_5/covidtest_multivar1_ethn.ster"
        data3: "output/warfarin_tempdata/sens_analysis_5/covidtest_multivar2_ethn.ster"
        data4: "output/warfarin_tempdata/sens_analysis_5/covidtest_multivar2_withoutethn.ster"
        data5: "output/warfarin_tempdata/sens_analysis_5/covidtest_multivar3_ethn.ster"
        data6: "output/warfarin_tempdata/sens_analysis_5/covidtest_multivar3_withoutethn.ster"

  # Exploratory Outcomes: Positive COVID test
  SA5_02b_cr_create_population_af_warfarin_positivecovidtest:
    run: stata-mp:latest analysis/SA5_02b_cr_create_population.do positivecovidtest SA5_af_warfarin
    needs: [02b_cr_create_population_af_warfarin_positivecovidtest]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/sens_analysis_5/SA5_02b_cr_create_population_positivecovidtest.log
      highly_sensitive:
        data1: "output/warfarin_tempdata/sens_analysis_5/last_date_positivecovidtest.dta"
        data2: "output/warfarin_tempdata/sens_analysis_5/warfarin_rx_positivecovidtest.dta"
        data3: "output/warfarin_tempdata/sens_analysis_5/doac_rx_positivecovidtest.dta"
        data4: "output/warfarin_tempdata/sens_analysis_5/oac_rx_positivecovidtest.dta"
        data5: "output/warfarin_tempdata/sens_analysis_5/analysis_dataset_STSET_positivecovidtest.dta"

  SA5_03b_an_checks_positivecovidtest:
    run: stata-mp:latest analysis/SA5_03b_an_checks.do SA5_af_warfarin positivecovidtest
    needs: [SA5_02b_cr_create_population_af_warfarin_positivecovidtest, SA5_05b_an_models_af_warfarin_positivecovidtest]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/sens_analysis_5/SA5_03b_an_checks_positivecovidtest.log
        table: "output/warfarin_tabfig/sens_analysis_5/time_updated_positivecovidtest.txt"

  SA5_05b_an_models_af_warfarin_positivecovidtest:
    run: stata-mp:latest analysis/05b_an_models.do positivecovidtest SA5_af_warfarin
    needs: [SA5_02b_cr_create_population_af_warfarin_positivecovidtest, 05b_an_models_af_warfarin_positivecovidtest]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/sens_analysis_5/05b_an_models_positivecovidtest.log
        table: "output/warfarin_tabfig/sens_analysis_5/table2_positivecovidtest.txt"
      highly_sensitive:
        data1: "output/warfarin_tempdata/sens_analysis_5/positivecovidtest_univar.ster"
        data2: "output/warfarin_tempdata/sens_analysis_5/positivecovidtest_multivar1.ster"
        data3: "output/warfarin_tempdata/sens_analysis_5/positivecovidtest_multivar2.ster"
        data4: "output/warfarin_tempdata/sens_analysis_5/positivecovidtest_multivar3.ster"

  SA5_06b_an_models_ethnicity_af_warfarin_positivecovidtest:
    run: stata-mp:latest analysis/06b_an_models_ethnicity.do positivecovidtest SA5_af_warfarin
    needs: [SA5_02b_cr_create_population_af_warfarin_positivecovidtest, 06b_an_models_ethnicity_af_warfarin_positivecovidtest]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/sens_analysis_5/06b_an_models_ethnicity_positivecovidtest.log
        table: "output/warfarin_tabfig/sens_analysis_5/table3_positivecovidtest.txt"
      highly_sensitive:
        data1: "output/warfarin_tempdata/sens_analysis_5/positivecovidtest_univar_ethn.ster"
        data2: "output/warfarin_tempdata/sens_analysis_5/positivecovidtest_multivar1_ethn.ster"
        data3: "output/warfarin_tempdata/sens_analysis_5/positivecovidtest_multivar2_ethn.ster"
        data4: "output/warfarin_tempdata/sens_analysis_5/positivecovidtest_multivar2_withoutethn.ster"
        data5: "output/warfarin_tempdata/sens_analysis_5/positivecovidtest_multivar3_ethn.ster"
        data6: "output/warfarin_tempdata/sens_analysis_5/positivecovidtest_multivar3_withoutethn.ster"

# Post-hoc Analysis 1
# Compare AF treated people with general population
# where general population was identified without exclusion criteria of no GP visit 1 year before entry
  generate_cohort_wo_GP:
    run: cohortextractor:latest generate_cohort --study-definition study_definition_general_population_wo_exclusion_GP_visit
    outputs:
      highly_sensitive:
        cohort: output/input_general_population_wo_exclusion_GP_visit.csv

  generate_cohort_wo_GP_flowchart:
    run: cohortextractor:latest generate_cohort --study-definition study_definition_general_population_wo_exclusion_GP_visit_flow_chart
    outputs:
      highly_sensitive:
        cohort: output/input_general_population_wo_exclusion_GP_visit_flow_chart.csv

  matching_second:
    run: python:latest python analysis/match_running_second.py
    needs: [generate_cohort, generate_cohort_wo_GP, 02ai_exportfile_matching]
    outputs:
      moderately_sensitive:
        log: output/matching_report_af_gen_pop_second.txt
      highly_sensitive:
        data1: "output/matched_cases_af_gen_pop_second.csv"
        data2: "output/matched_matches_af_gen_pop_second.csv"

  format_dataset_af_match_second:
    run: stata-mp:latest analysis/00_cr_create_analysis_dataset.do posthoc_1_af_match matched_matches_af_gen_pop_second
    needs: [generate_cohort, generate_cohort_wo_GP, matching_second]
    outputs:
      moderately_sensitive:
        log: output/post_hoc_1_oac_match_log/00_cr_create_analysis_dataset.log
      highly_sensitive:
        data: "output/post_hoc_1_oac_match_tempdata/format_dataset.dta"

  create_dataset_af_match_second:
    run: stata-mp:latest analysis/01c_cr_create_exposure_outcome_af_match.do posthoc_1_af_match
    needs: [format_dataset_af_match_second, matching_second]
    outputs:
      moderately_sensitive:
        log: output/post_hoc_1_oac_match_log/01c_cr_create_exposure_outcome_af_match.log
      highly_sensitive:
        data: "output/post_hoc_1_oac_match_tempdata/cr_dataset_af.dta"

  # Primary Outcomes: ONS COVID-19 death
  02c_cr_create_population_af_match_onscoviddeath_second:
    run: stata-mp:latest analysis/02c_cr_create_population.do onscoviddeath posthoc_1_af_match matched_cases_af_gen_pop_second
    needs: [create_dataset_af_match_second, matching_second, 02ai_exportfile_matching]
    outputs:
      moderately_sensitive:
        log: output/post_hoc_1_oac_match_log/02c_cr_create_population_onscoviddeath.log
      highly_sensitive:
        data1: "output/post_hoc_1_oac_match_tempdata/matched_control_onscoviddeath.dta"
        data2: "output/post_hoc_1_oac_match_tempdata/analysis_dataset_onscoviddeath.dta"
        data3: "output/post_hoc_1_oac_match_tempdata/analysis_dataset_STSET_onscoviddeath.dta"

  04_an_descriptive_table_af_match_onscoviddeath_second:
    run: stata-mp:latest analysis/04_an_descriptive_table.do onscoviddeath posthoc_1_af_match
    needs: [02c_cr_create_population_af_match_onscoviddeath_second]
    outputs:
      moderately_sensitive:
        log: output/post_hoc_1_oac_match_log/04_an_descriptive_table_onscoviddeath.log
        table: "output/post_hoc_1_oac_match_tabfig/table1_onscoviddeath.txt"

# Post-hoc Analysis 2
# Compare AF treated people with general population
# Interaction with care home residence

  10a_an_models_int_af_oac_positivecovidtest:
    run: stata-mp:latest analysis/10a_an_models_interact.do positivecovidtest af_oac
    needs: [02aii_cr_create_population_af_oac_positivecovidtest]
    outputs:
      moderately_sensitive:
        log: output/oac_log/10a_an_models_interact_positivecovidtest.log
        table: "output/oac_tabfig/table7_positivecovidtest.txt"
      highly_sensitive:
        data1: "output/oac_tempdata/positivecovidtest_univar_int.ster"
        data2: "output/oac_tempdata/positivecovidtest_multivar1_int.ster"
        data3: "output/oac_tempdata/positivecovidtest_multivar2_int.ster"
        data4: "output/oac_tempdata/positivecovidtest_multivar3_int.ster"

  # Post-hoc analyses for different causes of death outcomes
  # ONS Myocardial infarction death
  02b_cr_create_population_af_warfarin_mi_ons:
    run: stata-mp:latest analysis/02b_cr_create_population.do mi_ons af_warfarin
    needs: [create_dataset_af_warfarin]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/02b_cr_create_population_mi_ons.log
      highly_sensitive:
        data1: "output/warfarin_tempdata/analysis_dataset_mi_ons.dta"
        data2: "output/warfarin_tempdata/analysis_dataset_STSET_mi_ons.dta"

  05b_an_models_af_warfarin_mi_ons:
    run: stata-mp:latest analysis/05b_an_models.do mi_ons af_warfarin
    needs: [02b_cr_create_population_af_warfarin_mi_ons]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/05b_an_models_mi_ons.log
        table: "output/warfarin_tabfig/table2_mi_ons.txt"
      highly_sensitive:
        data1: "output/warfarin_tempdata/mi_ons_univar.ster"
        data2: "output/warfarin_tempdata/mi_ons_multivar1.ster"
        data3: "output/warfarin_tempdata/mi_ons_multivar2.ster"
        data4: "output/warfarin_tempdata/mi_ons_multivar3.ster"

  06b_an_models_ethnicity_af_warfarin_mi_ons:
    run: stata-mp:latest analysis/06b_an_models_ethnicity.do mi_ons af_warfarin
    needs: [02b_cr_create_population_af_warfarin_mi_ons]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/06b_an_models_ethnicity_mi_ons.log
        table: "output/warfarin_tabfig/table3_mi_ons.txt"
      highly_sensitive:
        data1: "output/warfarin_tempdata/mi_ons_univar_ethn.ster"
        data2: "output/warfarin_tempdata/mi_ons_multivar1_ethn.ster"
        data3: "output/warfarin_tempdata/mi_ons_multivar2_ethn.ster"
        data4: "output/warfarin_tempdata/mi_ons_multivar2_withoutethn.ster"
        data5: "output/warfarin_tempdata/mi_ons_multivar3_ethn.ster"
        data6: "output/warfarin_tempdata/mi_ons_multivar3_withoutethn.ster"

  # ONS Ischaemic stroke death
  02b_cr_create_population_af_warfarin_stroke_ons:
    run: stata-mp:latest analysis/02b_cr_create_population.do stroke_ons af_warfarin
    needs: [create_dataset_af_warfarin]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/02b_cr_create_population_stroke_ons.log
      highly_sensitive:
        data1: "output/warfarin_tempdata/analysis_dataset_stroke_ons.dta"
        data2: "output/warfarin_tempdata/analysis_dataset_STSET_stroke_ons.dta"

  05b_an_models_af_warfarin_stroke_ons:
    run: stata-mp:latest analysis/05b_an_models.do stroke_ons af_warfarin
    needs: [02b_cr_create_population_af_warfarin_stroke_ons]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/05b_an_models_stroke_ons.log
        table: "output/warfarin_tabfig/table2_stroke_ons.txt"
      highly_sensitive:
        data1: "output/warfarin_tempdata/stroke_ons_univar.ster"
        data2: "output/warfarin_tempdata/stroke_ons_multivar1.ster"
        data3: "output/warfarin_tempdata/stroke_ons_multivar2.ster"
        data4: "output/warfarin_tempdata/stroke_ons_multivar3.ster"

  06b_an_models_ethnicity_af_warfarin_stroke_ons:
    run: stata-mp:latest analysis/06b_an_models_ethnicity.do stroke_ons af_warfarin
    needs: [02b_cr_create_population_af_warfarin_stroke_ons]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/06b_an_models_ethnicity_stroke_ons.log
        table: "output/warfarin_tabfig/table3_stroke_ons.txt"
      highly_sensitive:
        data1: "output/warfarin_tempdata/stroke_ons_univar_ethn.ster"
        data2: "output/warfarin_tempdata/stroke_ons_multivar1_ethn.ster"
        data3: "output/warfarin_tempdata/stroke_ons_multivar2_ethn.ster"
        data4: "output/warfarin_tempdata/stroke_ons_multivar2_withoutethn.ster"
        data5: "output/warfarin_tempdata/stroke_ons_multivar3_ethn.ster"
        data6: "output/warfarin_tempdata/stroke_ons_multivar3_withoutethn.ster"

  # ONS VTE death
  02b_cr_create_population_af_warfarin_vte_ons:
    run: stata-mp:latest analysis/02b_cr_create_population.do vte_ons af_warfarin
    needs: [create_dataset_af_warfarin]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/02b_cr_create_population_vte_ons.log
      highly_sensitive:
        data1: "output/warfarin_tempdata/analysis_dataset_vte_ons.dta"
        data2: "output/warfarin_tempdata/analysis_dataset_STSET_vte_ons.dta"

  05b_an_models_af_warfarin_vte_ons:
    run: stata-mp:latest analysis/05b_an_models.do vte_ons af_warfarin
    needs: [02b_cr_create_population_af_warfarin_vte_ons]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/05b_an_models_vte_ons.log
        table: "output/warfarin_tabfig/table2_vte_ons.txt"
      highly_sensitive:
        data1: "output/warfarin_tempdata/vte_ons_univar.ster"
        data2: "output/warfarin_tempdata/vte_ons_multivar1.ster"
        data3: "output/warfarin_tempdata/vte_ons_multivar2.ster"
        data4: "output/warfarin_tempdata/vte_ons_multivar3.ster"

  06b_an_models_ethnicity_af_warfarin_vte_ons:
    run: stata-mp:latest analysis/06b_an_models_ethnicity.do vte_ons af_warfarin
    needs: [02b_cr_create_population_af_warfarin_vte_ons]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/06b_an_models_ethnicity_vte_ons.log
        table: "output/warfarin_tabfig/table3_vte_ons.txt"
      highly_sensitive:
        data1: "output/warfarin_tempdata/vte_ons_univar_ethn.ster"
        data2: "output/warfarin_tempdata/vte_ons_multivar1_ethn.ster"
        data3: "output/warfarin_tempdata/vte_ons_multivar2_ethn.ster"
        data4: "output/warfarin_tempdata/vte_ons_multivar2_withoutethn.ster"
        data5: "output/warfarin_tempdata/vte_ons_multivar3_ethn.ster"
        data6: "output/warfarin_tempdata/vte_ons_multivar3_withoutethn.ster"

  # ONS GI bleed death
  02b_cr_create_population_af_warfarin_gi_bleed_ons:
    run: stata-mp:latest analysis/02b_cr_create_population.do gi_bleed_ons af_warfarin
    needs: [create_dataset_af_warfarin]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/02b_cr_create_population_gi_bleed_ons.log
      highly_sensitive:
        data1: "output/warfarin_tempdata/analysis_dataset_gi_bleed_ons.dta"
        data2: "output/warfarin_tempdata/analysis_dataset_STSET_gi_bleed_ons.dta"

  05b_an_models_af_warfarin_gi_bleed_ons:
    run: stata-mp:latest analysis/05b_an_models.do gi_bleed_ons af_warfarin
    needs: [02b_cr_create_population_af_warfarin_gi_bleed_ons]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/05b_an_models_gi_bleed_ons.log
        table: "output/warfarin_tabfig/table2_gi_bleed_ons.txt"
      highly_sensitive:
        data1: "output/warfarin_tempdata/gi_bleed_ons_univar.ster"
        data2: "output/warfarin_tempdata/gi_bleed_ons_multivar1.ster"
        data3: "output/warfarin_tempdata/gi_bleed_ons_multivar2.ster"
        data4: "output/warfarin_tempdata/gi_bleed_ons_multivar3.ster"

  06b_an_models_ethnicity_af_warfarin_gi_bleed_ons:
    run: stata-mp:latest analysis/06b_an_models_ethnicity.do gi_bleed_ons af_warfarin
    needs: [02b_cr_create_population_af_warfarin_gi_bleed_ons]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/06b_an_models_ethnicity_gi_bleed_ons.log
        table: "output/warfarin_tabfig/table3_gi_bleed_ons.txt"
      highly_sensitive:
        data1: "output/warfarin_tempdata/gi_bleed_ons_univar_ethn.ster"
        data2: "output/warfarin_tempdata/gi_bleed_ons_multivar1_ethn.ster"
        data3: "output/warfarin_tempdata/gi_bleed_ons_multivar2_ethn.ster"
        data4: "output/warfarin_tempdata/gi_bleed_ons_multivar2_withoutethn.ster"
        data5: "output/warfarin_tempdata/gi_bleed_ons_multivar3_ethn.ster"
        data6: "output/warfarin_tempdata/gi_bleed_ons_multivar3_withoutethn.ster"
        
  # ONS Intracranial bleed death
  02b_cr_create_population_af_warfarin_intracranial_bleed_ons:
    run: stata-mp:latest analysis/02b_cr_create_population.do intracranial_bleed_ons af_warfarin
    needs: [create_dataset_af_warfarin]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/02b_cr_create_population_intracranial_bleed_ons.log
      highly_sensitive:
        data1: "output/warfarin_tempdata/analysis_dataset_intracranial_bleed_ons.dta"
        data2: "output/warfarin_tempdata/analysis_dataset_STSET_intracranial_bleed_ons.dta"

  05b_an_models_af_warfarin_intracranial_bleed_ons:
    run: stata-mp:latest analysis/05b_an_models.do intracranial_bleed_ons af_warfarin
    needs: [02b_cr_create_population_af_warfarin_intracranial_bleed_ons]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/05b_an_models_intracranial_bleed_ons.log
        table: "output/warfarin_tabfig/table2_intracranial_bleed_ons.txt"
      highly_sensitive:
        data1: "output/warfarin_tempdata/intracranial_bleed_ons_univar.ster"
        data2: "output/warfarin_tempdata/intracranial_bleed_ons_multivar1.ster"
        data3: "output/warfarin_tempdata/intracranial_bleed_ons_multivar2.ster"
        data4: "output/warfarin_tempdata/intracranial_bleed_ons_multivar3.ster"

  06b_an_models_ethnicity_af_warfarin_intracranial_bleed_ons:
    run: stata-mp:latest analysis/06b_an_models_ethnicity.do intracranial_bleed_ons af_warfarin
    needs: [02b_cr_create_population_af_warfarin_intracranial_bleed_ons]
    outputs:
      moderately_sensitive:
        log: output/warfarin_log/06b_an_models_ethnicity_intracranial_bleed_ons.log
        table: "output/warfarin_tabfig/table3_intracranial_bleed_ons.txt"
      highly_sensitive:
        data1: "output/warfarin_tempdata/intracranial_bleed_ons_univar_ethn.ster"
        data2: "output/warfarin_tempdata/intracranial_bleed_ons_multivar1_ethn.ster"
        data3: "output/warfarin_tempdata/intracranial_bleed_ons_multivar2_ethn.ster"
        data4: "output/warfarin_tempdata/intracranial_bleed_ons_multivar2_withoutethn.ster"
        data5: "output/warfarin_tempdata/intracranial_bleed_ons_multivar3_ethn.ster"
        data6: "output/warfarin_tempdata/intracranial_bleed_ons_multivar3_withoutethn.ster"